<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Quel est votre profil digestif ? - Quiz personnalis√©</title>

  <!-- ic√¥nes (facultatif) -->
  <link rel="icon" type="image/png" href="/13114230/687b524473004_Votretextedeparagraphe1.png" />
  <link rel="apple-touch-icon" href="/13114230/687b524473004_Votretextedeparagraphe1.png" />

  <style>
    /* Reset & base */
    * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html, body { height:100vh; height:100dvh; width:100%; overflow:hidden; }
    body { font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Inter',Roboto,'Helvetica Neue',Arial,sans-serif; background:#fff; }

    /* App shell */
    .app-container{ background:#fff; width:100%; height:100vh; height:100dvh; display:flex; flex-direction:column; overflow:hidden; }
    @media (min-width:600px){ .app-container{ max-width:500px; margin:0 auto; } }

    .app-header{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; background:#fff; border-bottom:1px solid rgba(0,0,0,.05); height:48px; position:relative; z-index:10; flex-shrink:0; }
    .back-button{ background:none; border:none; color:#64748b; cursor:pointer; padding:6px; border-radius:8px; width:32px; height:32px; display:flex; align-items:center; justify-content:center; transition:.2s; }
    .back-button:hover{ background:rgba(139,92,246,.1); color:#7c3aed; }
    .back-button svg{ width:18px; height:18px; }
    .app-logo{ font-size:1rem; font-weight:600; background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; position:absolute; left:50%; transform:translateX(-50%); }
    .header-right{ display:flex; align-items:center; gap:10px; }
    .step-counter{ font-size:.8rem; color:#64748b; font-weight:500; min-width:44px; text-align:right; }

    .progress-bar{ height:2px; background:rgba(0,0,0,.05); position:relative; overflow:hidden; flex-shrink:0; }
    .progress-fill{ height:100%; background:linear-gradient(90deg,#8b5cf6 0%,#7c3aed 100%); transition:width .5s cubic-bezier(.4,0,.2,1); }

    .app-content{ flex:1; display:flex; flex-direction:column; overflow:hidden; padding:16px; min-height:0; }
    .question-section{ display:none; flex:1; flex-direction:column; animation:slideIn .25s ease; overflow:hidden; }
    .question-section.active{ display:flex; }

    @keyframes slideIn{ from{ opacity:0; transform:translateY(10px); } to{ opacity:1; transform:translateY(0); } }

    .question-content{ flex:1; display:flex; flex-direction:column; overflow-y:auto; overflow-x:hidden; -webkit-overflow-scrolling:touch; padding:4px; margin:-4px; }
    .question-header{ margin-bottom:20px; flex-shrink:0; }
    .question-title{ font-size:1.4rem; font-weight:800; color:#1e293b; margin-bottom:8px; line-height:1.3; }
    .question-subtitle{ font-size:.95rem; color:#64748b; line-height:1.5; }

    .options-container{ display:flex; flex-direction:column; gap:8px; flex:1; min-height:0; }
    .options-grid{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:14px; }
    .options-grid-mobile-2{ grid-template-columns:repeat(2,minmax(0,1fr)); }

    .option-card{ background:#fff; border:2px solid #e5e7eb; border-radius:12px; padding:12px; cursor:pointer; transition:.18s; display:flex; align-items:center; gap:10px; flex-shrink:0; }
    .option-card:hover{ border-color:#8b5cf6; background:rgba(139,92,246,.02); }
    .option-card.selected{ border-color:#8b5cf6; background:rgba(139,92,246,.05); }

    .option-emoji{ font-size:1.6rem; flex-shrink:0; }
    .option-text{ flex:1; }
    .option-label{ font-size:.95rem; font-weight:700; color:#1e293b; margin-bottom:1px; }
    .option-description{ font-size:.8rem; color:#64748b; line-height:1.35; }
    .option-card input[type="checkbox"]{ width:18px; height:18px; cursor:pointer; flex-shrink:0; accent-color:#8b5cf6; }

    /* cartes image (Q1) */
    .option-card.image-option{ flex-direction:column; align-items:center; gap:16px; padding:32px 18px 20px; overflow:visible; position:relative; }
    .option-card.image-option .option-image-wrapper{ width:100%; display:flex; justify-content:center; position:relative; margin-top:-36px; }
    .option-card.image-option .option-image{ width:100%; display:block; aspect-ratio:3/4; object-fit:cover; object-position:top center; border-radius:16px; box-shadow:0 8px 18px rgba(15,23,42,.12); transform:translateY(-18px); }
    .option-card.image-option .option-text{ width:100%; display:flex; align-items:center; justify-content:center; padding:0 44px 0 4px; position:relative; }
    .option-card.image-option .option-label{ font-size:1.05rem; text-align:center; }
    .option-card.image-option .option-arrow{ position:absolute; right:0; top:50%; transform:translateY(-50%); width:36px; height:36px; border-radius:50%; background:rgba(15,23,42,.05); display:flex; align-items:center; justify-content:center; color:#1e293b; font-weight:700; font-size:1rem; box-shadow:0 2px 6px rgba(15,23,42,.12); transition:.18s; }
    .option-card.image-option.selected .option-arrow{ background:rgba(139,92,246,.15); color:#7c3aed; transform:translateY(-50%) scale(1.05); }

    @media (max-width:599px){
      .option-card.image-option{ padding:28px 16px 18px; gap:14px; }
      .option-card.image-option .option-image-wrapper{ margin-top:-32px; }
      .option-card.image-option .option-arrow{ width:32px; height:32px; right:2px; }
      .options-grid{ grid-template-columns:1fr; }
      .options-grid-mobile-2{ grid-template-columns:repeat(2,minmax(0,1fr)); }
    }

    /* bouton continuer g√©n√©rique */
    .continue-button{ width:100%; background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 100%); color:#fff; border:none; border-radius:12px; padding:16px; font-size:1rem; font-weight:700; cursor:pointer; margin-top:16px; transition:.18s; box-shadow:0 2px 8px rgba(139,92,246,.2); }
    .continue-button:hover{ transform:translateY(-1px); box-shadow:0 4px 12px rgba(139,92,246,.3); }
    .continue-button:disabled{ opacity:.5; cursor:not-allowed; transform:none; }

    /* Scroller pour listes de choix longues */
    .options-scroll-container{ display:flex; flex-direction:column; gap:12px; max-height:320px; overflow-y:auto; padding-right:4px; }
    .options-scroll-container::-webkit-scrollbar{ width:6px; }
    .options-scroll-container::-webkit-scrollbar-thumb{ background:rgba(124,58,237,.3); border-radius:999px; }

    /* ===== Q1 ‚Äî grille 2√ó2 pleine hauteur (images bien cadr√©es) ===== */
    .q1 .question-content{ display:flex; flex-direction:column; min-height:0; }
    .q1 .options-container{ flex:1; min-height:0; }
    .q1 .options-grid{ display:grid !important; height:100%; grid-template-columns:repeat(2,1fr)!important; grid-template-rows:repeat(2,minmax(0,1fr))!important; gap:10px!important; }
    .q1 .option-card.image-option{ height:100%!important; display:flex!important; flex-direction:column!important; padding:10px 10px 6px!important; border-radius:12px!important; overflow:visible!important; }
    .q1 .option-image-wrapper{ flex:1 1 auto!important; display:block!important; position:relative!important; margin:0!important; overflow:visible!important; }
    .q1 .option-image{ width:100%!important; height:100%!important; object-fit:cover!important; object-position:50% 0%!important; border-radius:12px!important; box-shadow:none!important; transform:translateY(-8px)!important; aspect-ratio:auto!important; }
    .q1 .option-text{ position:relative!important; display:flex!important; align-items:center!important; justify-content:center!important; min-height:44px!important; padding:0 28px!important; text-align:center!important; }
    .q1 .option-label{ font-weight:800!important; font-size:.98rem!important; }
    .q1 .option-arrow{ width:28px!important; height:28px!important; right:0; top:50%; position:absolute; transform:translateY(-50%); border-radius:50%; background:rgba(15,23,42,.06); display:flex; align-items:center; justify-content:center; }
    .q1 .question-header{ margin-bottom:8px; }
    .q1 .question-title{ font-size:1.16rem; margin-bottom:4px; }
    .q1 .question-subtitle{ font-size:.9rem; }
    @media (max-height:700px){
      .q1 .option-card.image-option{ padding:10px 8px 6px; }
      .q1 .option-image-wrapper{ margin-top:-10px; }
      .q1 .option-image{ transform:translateY(-5px); }
      .q1 .option-text{ min-height:38px; }
    }

    /* ===== Overlay R√©sultats / Loader (affich√© avant l‚Äôemail) ===== */
    .result-wrapper{
      background:#ffffff;
      height:100vh; height:100dvh;
      display:none;
      flex-direction:column;
      align-items:center; justify-content:center;
      padding:16px; overflow:hidden;
      position:fixed; inset:0; z-index:30;
    }
    .result-wrapper .container{ width:100%; max-width:480px; animation:fadeIn .5s ease; }
    .result-wrapper .header-title{ text-align:center; color:#1e293b; font-size:1.5rem; font-weight:800; margin-bottom:24px; line-height:1.2; transition:all .4s ease; }
    .progress-card{ background:#fff; border-radius:16px; padding:24px 20px; box-shadow:0 8px 24px rgba(0,0,0,.1); border:2px solid #e5e7eb; position:relative; transition:all .4s ease; }
    .progress-card.hidden{ opacity:0; transform:scale(.95); pointer-events:none; }
    .progress-header{ margin-bottom:20px; }
    .progress-percentage{ font-size:2.2rem; font-weight:800; background:linear-gradient(135deg,#10b981 0%,#059669 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; margin-bottom:6px; }
    .progress-subtitle{ color:#64748b; font-size:.9rem; }
    .progress-bar-container{ height:6px; background:#e5e7eb; border-radius:100px; overflow:hidden; margin-bottom:24px; position:relative; }
    .progress-bar-fill{ height:100%; background:linear-gradient(90deg,#10b981 0%,#059669 100%); border-radius:100px; width:0%; transition:width .5s cubic-bezier(.4,0,.2,1); position:relative; overflow:hidden; }
    .progress-bar-fill::after{ content:''; position:absolute; inset:0; background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent); animation:shimmer 2s infinite; }
    @keyframes shimmer{ 0%{ transform:translateX(-100%);} 100%{ transform:translateX(100%);} }
    .checklist{ display:flex; flex-direction:column; gap:12px; margin-bottom:20px; }
    .checklist-item{ display:flex; align-items:center; gap:10px; opacity:.5; transition:opacity .3s ease; }
    .checklist-item.active{ opacity:1; }
    .checklist-icon{ width:20px; height:20px; border:2px solid #e5e7eb; border-radius:50%; display:flex; align-items:center; justify-content:center; transition:all .3s ease; flex-shrink:0; }
    .checklist-item.completed .checklist-icon{ background:linear-gradient(135deg,#10b981 0%,#059669 100%); border-color:transparent; }
    .checklist-icon svg{ width:12px; height:12px; stroke:#fff; stroke-width:3; fill:none; opacity:0; transform:scale(0); transition:all .3s ease; }
    .checklist-item.completed .checklist-icon svg{ opacity:1; transform:scale(1); }
    .checklist-text{ color:#334155; font-size:.85rem; font-weight:600; line-height:1.2; }

    .success-card{ background:#f0fdf4; border:2px solid #bbf7d0; border-radius:16px; padding:20px; display:none; }
    .success-card.visible{ display:block; }
    .success-title{ font-size:1.1rem; font-weight:800; color:#166534; margin-bottom:8px; }
    .success-text{ color:#065f46; font-size:.95rem; line-height:1.5; margin-bottom:14px; }
    .success-cta{ width:100%; border:none; border-radius:12px; padding:14px; font-weight:800; font-size:1rem; cursor:pointer; background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 100%); color:#fff; }

    /* ===== Etape email : ne garder que le bouton SIO ===== */
    #emailQuestion .email-step-actions .continue-button{ display:none !important; } /* on cache notre bouton */
    /* style du bouton SIO une fois dans l‚Äô√©tape email */
    #emailQuestion form button,
    #emailQuestion form input[type="submit"],
    #emailQuestion [data-test-id="send-form-button"],
    #emailQuestion [data-testid="send-form-button"],
    #emailQuestion .sio-subscribe-button,
    #emailQuestion .sio-submit,
    #emailQuestion [data-element="cta-button"],
    #emailQuestion button[id^="button-"]{
      display:block !important; width:100% !important;
      background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 100%) !important;
      color:#fff !important; border:none !important; border-radius:12px !important;
      padding:16px !important; font-size:1rem !important; font-weight:800 !important;
      box-shadow:0 2px 8px rgba(139,92,246,.2) !important;
      visibility:visible !important;
    }

    /* Gate CSS : masque inputs SIO globaux, n‚Äôaffiche que dans #sioEmailSlot */
    input[name="first_name"], input[name="surname"], input[name="email"]{ display:none !important; }
    #sioEmailSlot input[name="first_name"],
    #sioEmailSlot input[name="surname"],
    #sioEmailSlot input[name="email"]{ display:block !important; }
  </style>
</head>

<body>
  <div class="app-container">
    <!-- Header -->
    <header class="app-header">
      <button class="back-button" id="backButton" aria-label="Retour">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
      </button>
      <div class="app-logo">Profil Digestif</div>
      <div class="header-right"><span class="step-counter" id="stepCounter">1/12</span></div>
    </header>

    <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 8.33%"></div></div>

    <!-- ===== Overlay R√©sultats (avant email) ===== -->
    <div id="resultsWrapper" class="result-wrapper" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="container">
        <h3 class="header-title">Nous analysons vos r√©ponses‚Ä¶</h3>

        <div id="searchProgressCard" class="progress-card">
          <div class="progress-header">
            <div id="searchProgressPercentage" class="progress-percentage">0%</div>
            <div class="progress-subtitle">Recherche de votre profil digestif</div>
          </div>

          <div class="progress-bar-container"><div id="searchProgressBar" class="progress-bar-fill"></div></div>

          <div class="checklist">
            <div class="checklist-item" data-step="1">
              <div class="checklist-icon">
                <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
              </div>
              <span class="checklist-text">Analyse des sympt√¥mes & de la fr√©quence</span>
            </div>
            <div class="checklist-item" data-step="2">
              <div class="checklist-icon">
                <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
              </div>
              <span class="checklist-text">Prise en compte de l‚Äôhistorique</span>
            </div>
            <div class="checklist-item" data-step="3">
              <div class="checklist-icon">
                <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
              </div>
              <span class="checklist-text">Construction de votre profil</span>
            </div>
          </div>
        </div>

        <div id="searchSuccessCard" class="success-card">
          <div class="success-title">C‚Äôest pr√™t ‚úÖ</div>
          <div class="success-text">Nous avons pr√©par√© votre profil personnalis√©. Entrez votre email pour recevoir vos r√©sultats d√©taill√©s.</div>
          <button id="goToEmailFromSuccess" class="success-cta" type="button">Voir mes r√©sultats</button>
        </div>
      </div>
    </div>
    <!-- ===== Fin overlay ===== -->

    <!-- ===== Contenu Quiz ===== -->
    <main class="app-content">

      <!-- Q1 -->
      <section class="question-section active q1" id="q1">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üì∏ Quelle est votre tranche d'√¢ge&nbsp;?</h2>
            <p class="question-subtitle">Nous utilisons uniquement votre √¢ge pour personnaliser vos r√©sultats.</p>
          </div>
          <div class="options-container options-grid options-grid-mobile-2">
            <div class="option-card image-option" data-value="18-29">
              <div class="option-image-wrapper">
                <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/6904ca78095ce_1.png" alt="18-29 ans" class="option-image">
              </div>
              <div class="option-text"><div class="option-label">18-29 ans</div><div class="option-arrow">‚Üí</div></div>
            </div>
            <div class="option-card image-option" data-value="30-39">
              <div class="option-image-wrapper">
                <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/6904ca85bcd66_11.png" alt="30-39 ans" class="option-image">
              </div>
              <div class="option-text"><div class="option-label">30-39 ans</div><div class="option-arrow">‚Üí</div></div>
            </div>
            <div class="option-card image-option" data-value="40-49">
              <div class="option-image-wrapper">
                <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/6904cf88c27a4_14.png" alt="40-49 ans" class="option-image">
              </div>
              <div class="option-text"><div class="option-label">40-49 ans</div><div class="option-arrow">‚Üí</div></div>
            </div>
            <div class="option-card image-option" data-value="50+">
              <div class="option-image-wrapper">
                <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/6904ca9d70e30_13.png" alt="50+ ans" class="option-image">
              </div>
              <div class="option-text"><div class="option-label">50+ ans</div><div class="option-arrow">‚Üí</div></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Q2 -->
      <section class="question-section" id="q2">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üî• Quel sympt√¥me digestif vous g√™ne le plus au quotidien&nbsp;?</h2>
            <p class="question-subtitle">S√©lectionnez celui qui vous affecte le plus</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="ballonnements"><span class="option-emoji">üî•</span><div class="option-text"><div class="option-label">Ballonnements persistants</div><div class="option-description">Ventre gonfl√©</div></div></div>
            <div class="option-card" data-value="douleurs"><span class="option-emoji">üí•</span><div class="option-text"><div class="option-label">Douleurs & crampes</div><div class="option-description">Sensations insupportables</div></div></div>
            <div class="option-card" data-value="transit"><span class="option-emoji">üöΩ</span><div class="option-text"><div class="option-label">Transit erratique</div><div class="option-description">Constipation, diarrh√©e, alternance</div></div></div>
            <div class="option-card" data-value="peur"><span class="option-emoji">üò∞</span><div class="option-text"><div class="option-label">Peur de manger</div><div class="option-description">Angoisse avant/apr√®s repas</div></div></div>
            <div class="option-card" data-value="tous"><span class="option-emoji">üå™Ô∏è</span><div class="option-text"><div class="option-label">Tous ces sympt√¥mes</div><div class="option-description">C‚Äôest un calvaire</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q3 -->
      <section class="question-section" id="q3">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üéöÔ∏è √Ä quelle fr√©quence avez-vous des ballonnements apr√®s les repas&nbsp;?</h2>
            <p class="question-subtitle">Choisissez la r√©ponse la plus juste</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="jamais"><span class="option-emoji">1</span><div class="option-text"><div class="option-label">1 Jamais</div></div></div>
            <div class="option-card" data-value="rarement"><span class="option-emoji">2</span><div class="option-text"><div class="option-label">2 Rarement</div></div></div>
            <div class="option-card" data-value="regulierement"><span class="option-emoji">3</span><div class="option-text"><div class="option-label">3 R√©guli√®rement</div></div></div>
            <div class="option-card" data-value="tres-souvent"><span class="option-emoji">4</span><div class="option-text"><div class="option-label">4 Tr√®s souvent</div></div></div>
            <div class="option-card" data-value="constamment"><span class="option-emoji">5</span><div class="option-text"><div class="option-label">5 Constamment</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q4 -->
      <section class="question-section" id="q4">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">‚è∞ Depuis combien de temps vivez-vous avec ces troubles&nbsp;?</h2>
            <p class="question-subtitle">Cela nous aide √† comprendre votre parcours</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="moins-6-mois"><span class="option-emoji">üïê</span><div class="option-text"><div class="option-label">Moins de 6 mois</div></div></div>
            <div class="option-card" data-value="6-mois-2-ans"><span class="option-emoji">üìÖ</span><div class="option-text"><div class="option-label">6 mois ‚Äì 2 ans</div></div></div>
            <div class="option-card" data-value="2-5-ans"><span class="option-emoji">‚è∞</span><div class="option-text"><div class="option-label">2 ‚Äì 5 ans</div></div></div>
            <div class="option-card" data-value="plus-5-ans"><span class="option-emoji">üòî</span><div class="option-text"><div class="option-label">Plus de 5 ans</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q5 -->
      <section class="question-section" id="q5">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üíî Quel est l‚Äôimpact sur votre quotidien&nbsp;?</h2>
            <p class="question-subtitle">S√©lectionnez toutes les r√©ponses qui s'appliquent</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="sorties"><input type="checkbox" /><span class="option-emoji">‚ùå</span><div class="option-text"><div class="option-label">J'√©vite les sorties</div></div></div>
            <div class="option-card" data-value="incomprise"><input type="checkbox" /><span class="option-emoji">üòî</span><div class="option-text"><div class="option-label">Je me sens incomprise</div></div></div>
            <div class="option-card" data-value="travail"><input type="checkbox" /><span class="option-emoji">üíº</span><div class="option-text"><div class="option-label">Impact sur le travail</div></div></div>
            <div class="option-card" data-value="fatigue"><input type="checkbox" /><span class="option-emoji">üò¥</span><div class="option-text"><div class="option-label">Fatigue constante</div></div></div>
            <div class="option-card" data-value="tete"><input type="checkbox" /><span class="option-emoji">üß†</span><div class="option-text"><div class="option-label">¬´‚ÄØC‚Äôest dans ma t√™te‚ÄØ¬ª</div></div></div>
            <div class="option-card" data-value="couple"><input type="checkbox" /><span class="option-emoji">üíî</span><div class="option-text"><div class="option-label">Vie de couple</div></div></div>
          </div>
        </div>
        <button class="continue-button" disabled>Continuer</button>
      </section>

      <!-- Q6 -->
      <section class="question-section" id="q6">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üîç Qu'avez-vous d√©j√† essay√©&nbsp;?</h2>
            <p class="question-subtitle">S√©lectionnez toutes les r√©ponses qui s'appliquent</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="medicaments"><input type="checkbox" /><span class="option-emoji">üíä</span><div class="option-text"><div class="option-label">M√©dicaments</div><div class="option-description">Anti-spasmodiques, laxatifs‚Ä¶</div></div></div>
            <div class="option-card" data-value="regimes"><input type="checkbox" /><span class="option-emoji">ü•ó</span><div class="option-text"><div class="option-label">R√©gimes restrictifs</div><div class="option-description">FODMAP, sans gluten, etc.</div></div></div>
            <div class="option-card" data-value="probiotiques"><input type="checkbox" /><span class="option-emoji">ü¶†</span><div class="option-text"><div class="option-label">Probiotiques</div></div></div>
            <div class="option-card" data-value="consultations"><input type="checkbox" /><span class="option-emoji">ü©∫</span><div class="option-text"><div class="option-label">Consultations</div><div class="option-description">Sans solution durable</div></div></div>
            <div class="option-card" data-value="naturel"><input type="checkbox" /><span class="option-emoji">üåø</span><div class="option-text"><div class="option-label">Rem√®des naturels</div></div></div>
            <div class="option-card" data-value="rien"><input type="checkbox" /><span class="option-emoji">üôÖ‚Äç‚ôÄÔ∏è</span><div class="option-text"><div class="option-label">Rien de tout √ßa</div></div></div>
          </div>
        </div>
        <button class="continue-button" disabled>Continuer</button>
      </section>

      <!-- Q7 -->
      <section class="question-section" id="q7">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üí≠ Quelle phrase vous correspond le plus&nbsp;?</h2>
            <p class="question-subtitle">Soyez honn√™te</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="marre"><span class="option-emoji">üò§</span><div class="option-text"><div class="option-label">Je veux une solution MAINTENANT</div></div></div>
            <div class="option-card" data-value="espoir"><span class="option-emoji">üòû</span><div class="option-text"><div class="option-label">Je perds espoir</div></div></div>
            <div class="option-card" data-value="sceptique"><span class="option-emoji">ü§î</span><div class="option-text"><div class="option-label">Je suis sceptique mais partante</div></div></div>
            <div class="option-card" data-value="determinee"><span class="option-emoji">üí™</span><div class="option-text"><div class="option-label">D√©termin√©e quoi qu‚Äôil en co√ªte</div></div></div>
            <div class="option-card" data-value="perdue"><span class="option-emoji">üÜò</span><div class="option-text"><div class="option-label">Je suis perdue</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q8 -->
      <section class="question-section" id="q8">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">‚ú® Si c‚Äô√©tait r√©gl√©, qu‚Äôest-ce qui changerait&nbsp;?</h2>
            <p class="question-subtitle">Projetez-vous sans ces troubles</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="sorties-plaisir"><span class="option-emoji">üéâ</span><div class="option-text"><div class="option-label">Sorties sans stress</div></div></div>
            <div class="option-card" data-value="manger-plaisir"><span class="option-emoji">üçΩÔ∏è</span><div class="option-text"><div class="option-label">Manger avec plaisir</div></div></div>
            <div class="option-card" data-value="energie"><span class="option-emoji">‚ö°</span><div class="option-text"><div class="option-label">Plus d‚Äô√©nergie</div></div></div>
            <div class="option-card" data-value="bien-etre"><span class="option-emoji">üßò‚Äç‚ôÄÔ∏è</span><div class="option-text"><div class="option-label">Bien dans mon corps</div></div></div>
            <div class="option-card" data-value="tout"><span class="option-emoji">üåü</span><div class="option-text"><div class="option-label">Toutes ces r√©ponses</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q9 -->
      <section class="question-section" id="q9">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üò∞ √Ä quelle fr√©quence √™tes‚Äëvous stress√©e&nbsp;?</h2>
            <p class="question-subtitle">Choisissez la r√©ponse qui convient</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="toujours"><span class="option-emoji">ü•µ</span><div class="option-text"><div class="option-label">Toujours</div></div></div>
            <div class="option-card" data-value="parfois"><span class="option-emoji">üòü</span><div class="option-text"><div class="option-label">Parfois</div></div></div>
            <div class="option-card" data-value="rarement"><span class="option-emoji">üôÇ</span><div class="option-text"><div class="option-label">Rarement</div></div></div>
            <div class="option-card" data-value="jamais"><span class="option-emoji">üòå</span><div class="option-text"><div class="option-label">Jamais</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q10 -->
      <section class="question-section" id="q10">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">‚è±Ô∏è Quand voulez‚Äëvous voir des r√©sultats&nbsp;?</h2>
            <p class="question-subtitle">Chaque parcours est unique</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="urgent"><span class="option-emoji">‚ö°</span><div class="option-text"><div class="option-label">Le plus vite possible</div><div class="option-description">√âch√©ance proche</div></div></div>
            <div class="option-card" data-value="3-4-semaines"><span class="option-emoji">üìÖ</span><div class="option-text"><div class="option-label">Dans 3‚Äì4 semaines</div></div></div>
            <div class="option-card" data-value="peu-importe"><span class="option-emoji">üéØ</span><div class="option-text"><div class="option-label">Peu importe si √ßa marche</div></div></div>
            <div class="option-card" data-value="progressif"><span class="option-emoji">üå±</span><div class="option-text"><div class="option-label">Progressif mais durable</div></div></div>
          </div>
        </div>
      </section>

      <!-- Q11 -->
      <section class="question-section" id="q11">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üïê Quand ressentez‚Äëvous l‚Äôinconfort&nbsp;?</h2>
            <p class="question-subtitle">S√©lectionnez toutes les r√©ponses qui s'appliquent</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="apres-repas"><input type="checkbox" /><span class="option-emoji">üçΩÔ∏è</span><div class="option-text"><div class="option-label">Apr√®s un repas</div></div></div>
            <div class="option-card" data-value="matin"><input type="checkbox" /><span class="option-emoji">üåÖ</span><div class="option-text"><div class="option-label">Au r√©veil</div></div></div>
            <div class="option-card" data-value="apres-boisson"><input type="checkbox" /><span class="option-emoji">ü•§</span><div class="option-text"><div class="option-label">Apr√®s avoir bu</div></div></div>
            <div class="option-card" data-value="coucher"><input type="checkbox" /><span class="option-emoji">üåô</span><div class="option-text"><div class="option-label">Au coucher</div></div></div>
            <div class="option-card" data-value="irregulier"><input type="checkbox" /><span class="option-emoji">üîÑ</span><div class="option-text"><div class="option-label">Irr√©gulier</div></div></div>
            <div class="option-card" data-value="aucun"><input type="checkbox" /><span class="option-emoji">üö´</span><div class="option-text"><div class="option-label">Aucun</div></div></div>
          </div>
        </div>
        <button class="continue-button" disabled>Continuer</button>
      </section>

      <!-- Q12 -->
      <section class="question-section" id="q12">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">üìä √Ä quelle fr√©quence avez‚Äëvous des troubles&nbsp;?</h2>
            <p class="question-subtitle">Choisissez une seule r√©ponse</p>
          </div>
          <div class="options-container">
            <div class="option-card" data-value="souvent"><span class="option-emoji">ü•∫</span><div class="option-text"><div class="option-label">Souvent</div></div></div>
            <div class="option-card" data-value="parfois"><span class="option-emoji">üòï</span><div class="option-text"><div class="option-label">Parfois</div></div></div>
            <div class="option-card" data-value="rarement"><span class="option-emoji">üôÇ</span><div class="option-text"><div class="option-label">Rarement</div></div></div>
          </div>
        </div>
      </section>

      <!-- EMAIL -->
      <section class="question-section" id="emailQuestion">
        <div class="question-content">
          <div class="question-header">
            <h2 class="question-title">D√©couvrez votre profil digestif personnalis√©</h2>
            <p class="question-subtitle">Entrez votre email pour recevoir vos r√©sultats d√©taill√©s et des conseils personnalis√©s</p>
          </div>

          <div class="options-scroll-container">
            <div id="sioEmailSlot" class="options-container">
              <!-- placeholder pendant l‚Äôinjection SIO -->
              <div id="sioEmailLoading" class="input-field" style="display:flex;align-items:center;justify-content:center;height:26.7px;">
                Chargement du formulaire‚Ä¶
              </div>
            </div>
          </div>
        </div>

        <div class="email-step-actions">
          <!-- notre bouton ‚Äúcontinuer‚Äù est masqu√© par CSS √† l‚Äô√©tape email -->
          <button class="continue-button" type="button">Continuer</button>
        </div>
      </section>

    </main>
    <!-- ===== Fin Contenu Quiz ===== -->
  </div>

  <script>
    /* =========================
       Etat & √©l√©ments
       ========================= */
    let currentStep = 1;
    const totalSteps = 12;
    const answers = {};

    const backButton   = document.getElementById('backButton');
    const stepCounter  = document.getElementById('stepCounter');
    const progressFill = document.getElementById('progressFill');

    const emailSection = document.getElementById('emailQuestion');
    const sioEmailSlot = document.getElementById('sioEmailSlot');

    backButton.addEventListener('click', () => { if (currentStep > 1) goToStep(currentStep - 1); });

    function updateUI(){
      stepCounter.textContent = `${currentStep}/${totalSteps}`;
      const progress = (currentStep / totalSteps) * 100;
      progressFill.style.width = `${progress}%`;
      backButton.style.visibility = currentStep > 1 ? 'visible' : 'hidden';
    }

    function goToStep(step){
      document.querySelectorAll('.question-section').forEach(s => s.classList.remove('active'));
      const target = document.getElementById(`q${step}`) || document.getElementById('emailQuestion');
      if (target){
        target.classList.add('active');
        currentStep = step;
        updateUI();
      }
    }

    /* ==========
       Wiring Q*
       ========== */
    document.querySelectorAll('.question-section').forEach((section, index) => {
      if (section.id === 'emailQuestion') return;

      const questionId    = `q${index + 1}`;
      const options       = section.querySelectorAll('.option-card');
      const continueBtn   = section.querySelector('.continue-button');
      const hasCheckboxes = section.querySelector('input[type="checkbox"]') !== null;

      if (!hasCheckboxes){
        options.forEach(option => {
          option.addEventListener('click', () => {
            options.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
            answers[questionId] = option.dataset.value;
            if (continueBtn) continueBtn.disabled = false;

            if (!continueBtn){
              if (index + 1 < totalSteps) goToStep(index + 2);
              else showResultsOverlay(); // apr√®s Q12 -> overlay
            }
          });
        });
      } else {
        options.forEach(option => {
          const checkbox = option.querySelector('input[type="checkbox"]');
          if (!checkbox) return;
          option.addEventListener('click', (e) => {
            if (e.target !== checkbox) checkbox.checked = !checkbox.checked;
            option.classList.toggle('selected', checkbox.checked);
            const checkedValues = Array.from(section.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.parentElement.dataset.value);
            answers[questionId] = checkedValues;
            if (continueBtn) continueBtn.disabled = checkedValues.length === 0;
          });
        });
      }

      if (continueBtn){
        continueBtn.addEventListener('click', () => {
          if (index + 1 < totalSteps) goToStep(index + 2);
          else showResultsOverlay(); // apr√®s Q12 -> overlay
        });
      }
    });

    /* =========================
       Overlay de chargement
       ========================= */
    const totalSearchSteps = 3;
    let searchProgress = 0;
    let currentSearchStep = 0;

    function showResultsOverlay(){
      const wrapper = document.getElementById('resultsWrapper');
      const progressCard = document.getElementById('searchProgressCard');
      const successCard  = document.getElementById('searchSuccessCard');

      wrapper.style.display = 'flex';
      wrapper.setAttribute('aria-hidden', 'false');
      progressCard.style.display = '';
      successCard.classList.remove('visible');
      successCard.style.display = 'none';

      document.querySelectorAll('.question-section').forEach(s => s.classList.remove('active'));
      currentStep = totalSteps;
      updateUI();

      startSearchProgress();
      console.log('%c[SIO][DBG]', 'color:#059669;font-weight:700', 'Overlay loader affich√©');
    }

    function startSearchProgress(){
      searchProgress = 0; currentSearchStep = 0;
      const wrapper = document.getElementById('resultsWrapper');
      const bar = wrapper.querySelector('#searchProgressBar');
      const percentage = wrapper.querySelector('#searchProgressPercentage');
      const items = wrapper.querySelectorAll('.checklist-item');

      bar.style.width = '0%';
      percentage.textContent = '0%';
      items.forEach(i => i.classList.remove('active','completed'));

      setTimeout(updateSearchProgress, 400);
    }

    function updateSearchProgress(){
      const wrapper = document.getElementById('resultsWrapper');
      const bar = wrapper.querySelector('#searchProgressBar');
      const percentage = wrapper.querySelector('#searchProgressPercentage');
      const items = wrapper.querySelectorAll('.checklist-item');

      searchProgress += 2; if (searchProgress > 100) searchProgress = 100;
      bar.style.width = searchProgress + '%';
      percentage.textContent = Math.floor(searchProgress) + '%';

      const stepProgress = Math.floor((searchProgress / 100) * totalSearchSteps);
      if (stepProgress > currentSearchStep){
        for (let i = currentSearchStep; i < stepProgress && i < totalSearchSteps; i++){
          setTimeout(() => {
            items[i].classList.add('active');
            setTimeout(() => { items[i].classList.add('completed'); }, 150);
          }, i * 100);
        }
        currentSearchStep = stepProgress;
      }

      if (searchProgress < 100){
        setTimeout(updateSearchProgress, 100);
      } else {
        items.forEach((item, idx) => { setTimeout(() => { item.classList.add('active','completed'); }, idx * 50); });
        setTimeout(showSearchSuccess, 900);
      }
    }

    function showSearchSuccess(){
      const progressCard = document.getElementById('searchProgressCard');
      const successCard  = document.getElementById('searchSuccessCard');
      const headerTitle  = document.querySelector('#resultsWrapper .header-title');

      progressCard.classList.add('hidden');
      headerTitle.style.opacity = '0';
      headerTitle.style.transform = 'translateY(-20px)';

      setTimeout(() => {
        progressCard.style.display = 'none';
        headerTitle.style.display = 'none';
        successCard.classList.add('visible');
        successCard.style.display = 'block';
        console.log('%c[SIO][DBG]', 'color:#059669;font-weight:700', 'Overlay loader termin√© ‚Üí carte succ√®s visible');
      }, 350);
    }

    document.getElementById('goToEmailFromSuccess').addEventListener('click', () => {
      hideResultsOverlay();
      showEmailQuestion();
    });

    function hideResultsOverlay(){
      const wrapper = document.getElementById('resultsWrapper');
      wrapper.style.display = 'none';
      wrapper.setAttribute('aria-hidden', 'true');
    }

    /* =========================
       Etape email (SIO)
       ========================= */
    function showEmailQuestion(){
      document.querySelectorAll('.question-section').forEach(s => s.classList.remove('active'));
      if (emailSection) emailSection.classList.add('active');
      currentStep = totalSteps;
      updateUI();
      const appContent = document.querySelector('.app-content'); if (appContent) appContent.scrollTop = 0;

      setTimeout(() => {
        // premier passage
        relocateSioIntoSlot();
        // observe les mutations 10s pour attraper les √©l√©ments SIO qui apparaissent plus tard
        const mo = new MutationObserver(() => relocateSioIntoSlot());
        mo.observe(document.body, { childList:true, subtree:true });
        setTimeout(() => mo.disconnect(), 10000);
      }, 0);

      console.log('%c[SIO][DBG]', 'color:#059669;font-weight:700', 'showEmailQuestion() ‚Üí √©tape email affich√©e');
    }

    function getSioSubmitButton(){
      const sel = [
        'button[type="submit"]',
        'input[type="submit"]',
        '.sio-subscribe-button',
        '.sio-submit',
        '[data-element="cta-button"]',
        '[data-test-id="send-form-button"]',
        '[data-testid="send-form-button"]',
        'button[id^="button-"]'
      ].join(', ');
      const slot = document.getElementById('sioEmailSlot');
      // d‚Äôabord dans le slot‚Ä¶
      let btn = slot ? slot.querySelector(sel) : null;
      // ‚Ä¶sinon global
      if (!btn) btn = document.querySelector(sel);
      return btn || null;
    }

    function clickSioSubmit(){
      const slot = document.getElementById('sioEmailSlot');
      const formInSlot = slot ? slot.querySelector('form') : null;
      const btn  = getSioSubmitButton();

      if (btn && typeof btn.click === 'function'){ btn.click(); console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Click bouton SIO'); return; }
      if (formInSlot){ if (formInSlot.requestSubmit) formInSlot.requestSubmit(); else formInSlot.submit(); console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Form.submit() SIO'); }
    }

    function relocateSioIntoSlot(){
      const slot = document.getElementById('sioEmailSlot');
      if (!slot){ console.warn('[SIO][DBG] slot email introuvable'); return; }

      // Gate CSS (au cas o√π)
      if (!document.getElementById('sioEmailGate')){
        const css = document.createElement('style');
        css.id = 'sioEmailGate';
        css.textContent = 'input[name="first_name"],input[name="surname"],input[name="email"]{display:none!important;} #sioEmailSlot input[name="first_name"],#sioEmailSlot input[name="surname"],#sioEmailSlot input[name="email"]{display:block!important;}';
        (document.head || document.documentElement).appendChild(css);
      }

      // Localise le champ email SIO n‚Äôimporte o√π
      const EMAIL_SEL = [
        'input[type="email"]',
        'input[name="email"]',
        'input[name*="email" i]',
        'input[id*="email" i]',
        'input[placeholder*="mail" i]',
        'input[id^="field-"]'
      ].join(', ');
      const email = document.querySelector(EMAIL_SEL);

      // D√©place le formulaire si possible
      if (email){
        const form = email.closest('form') || email.form;
        if (form && !slot.contains(form)){
          slot.innerHTML = '';
          slot.appendChild(form);
          console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Formulaire SIO d√©plac√© ‚Üí #sioEmailSlot');
        }else if(!form && !slot.contains(email)){
          slot.innerHTML = '';
          slot.appendChild(email);
          console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Input email SIO d√©plac√© ‚Üí #sioEmailSlot (pas de <form>)');
        }
      }

      // Trouve le bouton SIO ; s‚Äôil n‚Äôest pas dans le slot, on le d√©place
      let btn = getSioSubmitButton();
      if (btn && !slot.contains(btn)){
        const ref = slot.querySelector('form') || slot;
        try{
          ref.appendChild(btn);
          console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Bouton SIO d√©plac√© ‚Üí #sioEmailSlot');
        }catch(_){}
      }

      // Style & accessibilit√©
      btn = getSioSubmitButton();
      if (btn){
        btn.disabled = false;
        btn.style.display = 'block';
        btn.style.visibility = 'visible';
        btn.style.width = '100%';
      }
      console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Bouton SIO natif trouv√© :', !!btn);

      // Entr√©e => submit
      const emailStep = document.getElementById('emailQuestion');
      if (emailStep && !emailStep.dataset.enterBound){
        emailStep.dataset.enterBound = '1';
        emailStep.addEventListener('keydown', (e) => {
          if (e.key === 'Enter'){
            e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
            clickSioSubmit();
          }
        }, { capture:true });
        console.log('%c[SIO][DBG]','color:#059669;font-weight:700','Listener Enter‚Üísubmit SIO ajout√©');
      }

      // retire le placeholder si un form ou input a √©t√© trouv√©
      const loading = document.getElementById('sioEmailLoading');
      if (loading && (slot.querySelector('form') || slot.querySelector(EMAIL_SEL))) loading.remove();
    }

    // ===== Init
    updateUI();
  </script>
</body>
</html>
