<!DOCTYPE html>
<html lang="fr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title>Trouvez votre job remote idéal - Quiz personnalisé</title>
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
           -webkit-tap-highlight-color: transparent;
       }

        html, body {
            height: 100vh;
            height: 100dvh;
            width: 100%;
            overflow: hidden;
        }

       body {
           font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, 'Helvetica Neue', Arial, sans-serif;
           background: #ffffff;
           margin: 0;
           padding: 0;
       }

       .app-container {
           background: #ffffff;
           width: 100%;
           height: 100vh;
           height: 100dvh;
           display: flex;
           flex-direction: column;
           overflow: hidden;
       }

       @media (min-width: 600px) {
           .app-container {
               max-width: 500px;
               margin: 0 auto;
           }

           .legal-toggle {
               display: none !important;
           }

           .legal-dropdown {
               display: none !important;
           }

           .legal-links {
               display: flex;
           }
       }

       .app-header {
           display: flex;
           align-items: center;
           justify-content: space-between;
           padding: 12px 16px;
           background: white;
           border-bottom: 1px solid rgba(0, 0, 0, 0.05);
           flex-shrink: 0;
           z-index: 10;
           height: 48px;
           position: relative;
       }

       .back-button {
           background: none;
           border: none;
           color: #64748b;
           cursor: pointer;
           padding: 6px;
           border-radius: 8px;
           transition: all 0.2s ease;
           display: flex;
           align-items: center;
           justify-content: center;
           width: 32px;
           height: 32px;
       }

       .back-button:hover {
           background: rgba(16, 185, 129, 0.1);
           color: #059669;
       }

       .back-button svg {
           width: 18px;
           height: 18px;
       }

       .app-logo {
           font-size: 1rem;
           font-weight: 600;
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           position: absolute;
           left: 50%;
           transform: translateX(-50%);
       }

       .header-right {
           display: flex;
           align-items: center;
           gap: 10px;
       }

       .step-counter {
           font-size: 0.8rem;
           color: #64748b;
           font-weight: 500;
           min-width: 44px;
           text-align: right;
       }

       .legal-toggle {
           display: none;
           align-items: center;
           justify-content: center;
           width: 32px;
           height: 32px;
           border-radius: 999px;
           border: 1px solid rgba(148, 163, 184, 0.4);
           background: rgba(148, 163, 184, 0.4);
           color: #1e293b;
           font-weight: 700;
           font-size: 1rem;
           cursor: pointer;
           transition: background 0.2s ease, color 0.2s ease;
       }

       .legal-toggle:focus-visible {
           outline: 2px solid #059669;
           outline-offset: 2px;
       }

       .legal-toggle:hover {
           background: rgba(15, 23, 42, 0.45);
           color: white;
       }

       .legal-dropdown {
           position: absolute;
           top: calc(100% + 8px);
           right: 16px;
           background: #ffffff;
           border: 1px solid rgba(15, 23, 42, 0.08);
           border-radius: 12px;
           box-shadow: 0 12px 30px rgba(15, 23, 42, 0.15);
           padding: 14px 16px;
           min-width: 220px;
           display: none;
           z-index: 30;
           text-align: left;
       }

       .legal-dropdown.show {
           display: block;
       }

       .legal-dropdown-links {
           display: flex;
           flex-direction: column;
           gap: 10px;
       }

       .legal-dropdown-links .legal-separator {
           display: none;
       }

       .legal-dropdown a {
           display: block;
           color: #1f2937;
           text-decoration: none;
           font-weight: 500;
           font-size: 0.9rem;
       }

       .legal-dropdown a:hover {
           color: #059669;
           text-decoration: underline;
       }

       .legal-links {
           display: flex;
           align-items: center;
           justify-content: center;
           gap: 8px;
           flex-wrap: wrap;
           font-size: 0.8rem;
           color: #64748b;
           text-align: center;
       }

       .legal-links a {
           color: inherit;
           text-decoration: none;
           font-weight: 500;
       }

       .legal-links a:hover {
           color: #059669;
           text-decoration: underline;
       }

       .legal-separator {
           color: rgba(100, 116, 139, 0.6);
       }

       @media (max-width: 599px) {
           .legal-links {
               display: none;
           }

           .legal-toggle {
               display: inline-flex;
           }

           .legal-dropdown {
               right: 12px;
           }
       }

       .progress-bar {
           height: 2px;
           background: rgba(0, 0, 0, 0.05);
           position: relative;
           overflow: hidden;
           flex-shrink: 0;
       }

       .progress-fill {
           height: 100%;
           background: linear-gradient(90deg, #10b981 0%, #059669 100%);
           transition: width 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
       }

       .app-content {
           flex: 1;
           display: flex;
           flex-direction: column;
           overflow: hidden;
           padding: 16px;
           min-height: 0;
       }

       .question-section {
           display: none;
           flex: 1;
           flex-direction: column;
           animation: slideIn 0.3s ease;
           overflow: hidden;
       }

       .question-section.active {
           display: flex;
       }

       .email-step {
           display: none;
           flex-direction: column;
           gap: 12px;
           animation: slideIn 0.3s ease;
       }

       .email-step.active {
           display: flex;
       }

       @keyframes slideIn {
           from {
               opacity: 0;
               transform: translateX(20px);
           }
           to {
               opacity: 1;
               transform: translateX(0);
           }
       }

       .question-header {
           margin-bottom: 16px;
           flex-shrink: 0;
       }

       .question-title {
           font-size: 1.2rem;
           font-weight: 600;
           color: #1e293b;
           margin-bottom: 6px;
           line-height: 1.2;
       }

       .question-subtitle {
           font-size: 0.85rem;
           color: #64748b;
           line-height: 1.4;
       }

       .options-scroll-container {
           flex: 1;
           overflow-y: auto;
           overflow-x: hidden;
           min-height: 0;
           -webkit-overflow-scrolling: touch;
       }

       .scroll-container-wrapper {
           position: relative;
           flex: 1;
           min-height: 0;
           display: flex;
           flex-direction: column;
       }

       .scroll-container-wrapper .options-scroll-container {
           flex: 1;
       }

       .scroll-indicator {
           position: absolute;
           left: 50%;
           bottom: 12px;
           transform: translate(-50%, 0);
           width: 36px;
           height: 36px;
           border-radius: 9999px;
           background: rgba(15, 23, 42, 0.88);
           color: #f8fafc;
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: 18px;
           pointer-events: none;
           box-shadow: 0 12px 24px rgba(15, 23, 42, 0.18);
           transition: opacity 0.3s ease, transform 0.3s ease;
           animation: scrollIndicatorPulse 1.8s ease-in-out infinite;
       }

       .scroll-indicator span {
           display: inline-flex;
           align-items: center;
           justify-content: center;
           transform: translateY(-1px);
       }

       .scroll-indicator.hidden {
           opacity: 0;
           transform: translate(-50%, 10px);
           visibility: hidden;
           animation: none;
       }

       @keyframes scrollIndicatorPulse {
           0%, 100% {
               transform: translate(-50%, 0);
           }
           50% {
               transform: translate(-50%, 6px);
           }
       }

       .options-container {
           display: flex;
           flex-direction: column;
           gap: 8px;
       }

       .option-card {
           background: #ffffff;
           border: 2px solid #e5e7eb;
           border-radius: 10px;
           padding: 12px 14px;
           cursor: pointer;
           transition: all 0.2s ease;
           display: flex;
           align-items: center;
           justify-content: flex-start;
           gap: 10px;
           position: relative;
           overflow: hidden;
           text-align: left;
           min-height: 48px;
       }

       .option-card:hover {
           border-color: #10b981;
           background: rgba(16, 185, 129, 0.05);
       }

       .option-card.selected {
           border-color: #10b981;
           background: rgba(16, 185, 129, 0.08);
       }

       .option-card input[type="radio"],
       .option-card input[type="checkbox"] {
           accent-color: #10b981;
           width: 18px;
           height: 18px;
           flex-shrink: 0;
       }

       .option-text {
           flex: 1;
           text-align: left;
           font-size: 0.9rem;
           color: #334155;
           font-weight: 500;
           line-height: 1.2;
           display: flex;
           flex-direction: column;
       }

       .option-card--other {
           align-items: flex-start;
       }

       .option-card--other .option-text {
           gap: 6px;
       }

       .option-other-input {
           width: 100%;
           padding: 8px 10px;
           border: 1px solid #cbd5f5;
           border-radius: 8px;
           font-size: 0.85rem;
           color: #1f2937;
           background: #f8fafc;
           transition: border-color 0.2s ease, box-shadow 0.2s ease;
       }

       .option-other-input:focus {
           outline: none;
           border-color: #10b981;
           box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15);
           background: #ffffff;
       }

       .option-subtext {
           font-size: 0.8rem;
           color: #64748b;
           font-weight: 400;
           margin-top: 2px;
       }

       .two-columns {
           display: grid;
           grid-template-columns: repeat(2, 1fr);
           gap: 8px;
       }

       .two-columns .option-card--other {
           grid-column: span 2;
       }

       @media (max-width: 380px) {
           .two-columns {
               grid-template-columns: 1fr;
           }
           .two-columns .option-card--other {
               grid-column: span 1;
           }
       }

       .select-country {
           width: 100%;
           padding: 12px 14px;
           border: 2px solid #e5e7eb;
           border-radius: 10px;
           font-size: 0.9rem;
           color: #334155;
           font-weight: 500;
           background: #ffffff;
           appearance: none;
           background-image: url('data:image/svg+xml,%3Csvg xmlns%3D"http://www.w3.org/2000/svg" viewBox%3D"0 0 20 20" fill%3D"%2364748b"%3E%3Cpath fill-rule%3D"evenodd" d%3D"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.25 8.27a.75.75 0 01-.02-1.06z" clip-rule%3D"evenodd" /%3E%3C/svg%3E');
           background-repeat: no-repeat;
           background-position: right 10px center;
           background-size: 18px;
       }

       .country-image {
           margin-top: 16px;
           display: block;
           width: 288px;
           height: 288px;
           object-fit: contain;
           margin-left: auto;
           margin-right: auto;
       }

       .input-field {
           width: 100%;
           padding: 6.7px 14px;
           background: #ffffff;
           border: 2px solid #e5e7eb;
           border-radius: 10px;
           font-size: 0.95rem;
           color: #1e293b;
           transition: all 0.3s ease;
           outline: none;
       }

       .input-field:focus {
           border-color: #10b981;
           box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
       }

       .file-upload {
           border: 2px dashed #d1d5db;
           border-radius: 10px;
           padding: 20px;
           text-align: center;
           cursor: pointer;
           transition: all 0.3s ease;
           background: rgba(16, 185, 129, 0.02);
       }

       .file-upload:hover {
           border-color: #10b981;
           background: rgba(16, 185, 129, 0.05);
       }

       .file-upload input[type="file"] {
           display: none;
       }

       .file-upload-icon {
           font-size: 1.8rem;
           margin-bottom: 6px;
       }

       .file-upload-text {
           color: #10b981;
           font-weight: 600;
           font-size: 0.9rem;
           margin-bottom: 3px;
       }

       .file-upload-subtext {
           color: #94a3b8;
           font-size: 0.75rem;
       }

       .uploaded-file {
           display: none;
           align-items: center;
           justify-content: center;
           gap: 8px;
           color: #10b981;
           font-weight: 600;
       }

       .remove-file {
           cursor: pointer;
           color: #ef4444;
           font-weight: bold;
       }

       .cv-reminder {
           margin-top: 10px;
           text-align: center;
           color: #1f2937;
           font-size: 0.85rem;
           font-weight: 500;
       }

       .salary-tabs {
           display: flex;
           gap: 4px;
           margin-bottom: 16px;
           background: #f1f5f9;
           padding: 3px;
           border-radius: 10px;
       }

       .salary-tab {
           flex: 1;
           padding: 6px 10px;
           border: none;
           border-radius: 8px;
           background: #fff;
           color: #374151;
           font-size: 0.85rem;
           font-weight: 500;
           cursor: pointer;
           transition: background 0.2s ease;
       }

       .salary-tab.active {
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           color: #fff;
       }

       .histogram-container {
           position: relative;
           max-width: 100%;
           margin: 0 auto;
           padding-bottom: 36px;
       }

       .histogram-bars {
           display: flex;
           align-items: flex-end;
           gap: 3px;
           height: 100px;
       }

       .histogram-bar {
           flex: 1;
           background: #e5e7eb;
           transition: background-color 0.2s ease;
       }

       .histogram-bar.in-range {
           background: #1f2937;
       }

       .range-track {
           position: absolute;
           bottom: 24px;
           left: 0;
           right: 0;
           height: 24px;
       }

       .range-line {
           position: absolute;
           top: 50%;
           left: 0;
           right: 0;
           height: 2px;
           margin-top: -1px;
           background: #1f2937;
       }

       .handle {
           position: absolute;
           top: 50%;
           width: 24px;
           height: 24px;
           border-radius: 50%;
           border: 2px solid #1f2937;
           background: #fff;
           cursor: pointer;
           transform: translate(-50%, -50%);
           z-index: 2;
       }

       .salary-inputs {
           display: flex;
           justify-content: center;
           gap: 16px;
           margin-top: 20px;
       }

       .salary-input {
           display: flex;
           flex-direction: column;
       }

       .salary-input label {
           font-size: 0.85rem;
           margin-bottom: 3px;
           color: #1f2937;
       }

       .input-wrapper {
           position: relative;
       }

       .input-wrapper input {
           width: 120px;
           padding: 8px 36px 8px 10px;
           border: 1px solid #e5e7eb;
           border-radius: 10px;
           font-size: 0.9rem;
       }

       .input-wrapper span {
           position: absolute;
           top: 50%;
           right: 10px;
           transform: translateY(-50%);
           color: #64748b;
           font-size: 0.8rem;
       }

       .app-footer {
           padding: 12px 16px 16px;
           background: white;
           border-top: 1px solid rgba(0, 0, 0, 0.05);
           flex-shrink: 0;
           display: flex;
           flex-direction: column;
           gap: 12px;
           align-items: center;
       }

       .continue-button {
           width: 100%;
           height: 44px;
           border-radius: 12px;
           border: 0;
           background: linear-gradient(135deg, #10b981, #059669);
           color: #fff;
           font-weight: 700;
           font-size: 16px;
           cursor: pointer;
           transition: all 0.2s ease;
       }

       .continue-button:hover {
           transform: translateY(-1px);
           box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
       }

       .continue-button:active {
           transform: translateY(0);
       }

       .continue-button.disabled {
           background: #e5e7eb;
           color: #94a3b8;
           cursor: not-allowed;
           box-shadow: none;
       }

       .continue-button.disabled:hover {
           transform: none;
       }

       #emailQuestion .continue-button {
           margin-top: 0;
           flex: 2;
       }

       .email-step-actions {
           display: flex;
           gap: 12px;
           margin-top: 24px;
       }

       .email-back-button {
           flex: 1;
           border: 2px solid #e5e7eb;
           border-radius: 10px;
           background: #ffffff;
           color: #1e293b;
           font-size: 0.95rem;
           font-weight: 600;
           padding: 12px 16px;
           cursor: pointer;
           transition: all 0.2s ease;
           display: none;
           align-items: center;
           justify-content: center;
       }

       .email-back-button:hover {
           border-color: #10b981;
           color: #059669;
       }

       .skip-link {
           text-align: center;
           margin-top: 10px;
       }

       .skip-link a {
           color: #94a3b8;
           text-decoration: none;
           font-size: 0.8rem;
           font-weight: 500;
           transition: color 0.2s ease;
       }

       .skip-link a:hover {
           color: #10b981;
       }

       .success-section {
           flex: 1;
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           padding: 30px 20px;
           text-align: center;
       }

       .success-icon {
           width: 70px;
           height: 70px;
           margin: 0 auto 20px;
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           border-radius: 50%;
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: 35px;
           color: white;
           box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
       }

       .success-title {
           font-size: 1.3rem;
           font-weight: 600;
           color: #1e293b;
           margin-bottom: 10px;
       }

       .success-text {
           color: #64748b;
           line-height: 1.5;
           margin-bottom: 8px;
           font-size: 0.9rem;
       }

       .success-tip {
           color: #94a3b8;
           font-size: 0.8rem;
           margin-top: 12px;
       }

       .info-screen {
           display: none;
           flex: 1;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           padding: 16px;
           text-align: center;
           gap: 14px;
           animation: slideIn 0.3s ease;
       }

       .info-screen.active {
           display: flex;
       }

       .reviews-screen {
           display: none;
           flex: 1;
           flex-direction: column;
           align-items: center;
           justify-content: flex-start;
           padding: 16px;
           text-align: center;
           gap: 12px;
           animation: slideIn 0.3s ease;
           overflow-y: auto;
       }

       .reviews-screen.active {
           display: flex;
       }

       .reviews-title {
           font-size: 1.3rem;
           font-weight: 600;
           color: #1e293b;
           margin-bottom: 8px;
       }

       .reviews-container {
           display: flex;
           flex-direction: column;
           gap: 12px;
           width: 100%;
       }

       .review-card {
           background: #ffffff;
           border: 2px solid #e5e7eb;
           border-radius: 10px;
           padding: 12px;
           text-align: left;
       }

       .review-header {
           display: flex;
           justify-content: space-between;
           margin-bottom: 6px;
           font-size: 0.85rem;
       }

       .review-author {
           font-weight: 600;
           color: #1e293b;
       }

       .review-stars {
           color: #f59e0b;
       }

       .review-text {
           font-size: 0.85rem;
           line-height: 1.3;
           color: #334155;
       }

       .trustpilot-placeholder {
           margin: 12px auto 0;
           color: #94a3b8;
           font-size: 0.85rem;
           width: min(200px, 60%);
           height: auto;
           display: block;
       }

       .info-illustration {
           width: min(288px, 30vh);
           height: min(288px, 30vh);
           background: none;
           border-radius: 0;
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: min(8rem, 20vh);
       }

       .info-illustration img {
           width: 100%;
           height: 100%;
           border-radius: 0;
           object-fit: contain;
       }

       .info-title {
           font-size: 1.3rem;
           font-weight: 600;
           color: #10b981;
       }

       .info-text {
           font-size: 0.9rem;
           line-height: 1.4;
           color: #334155;
           max-width: 380px;
       }

       .info-text strong {
           color: #1e293b;
           font-weight: 600;
       }

       .experience-cards {
           display: grid;
           grid-template-columns: repeat(2, 1fr);
           gap: 10px;
           margin-bottom: 16px;
           width: 100%;
       }

       .experience-card {
           background: white;
           border: 2px solid #e5e7eb;
           border-radius: 12px;
           padding: 12px;
           cursor: pointer;
           transition: all 0.2s ease;
           text-align: center;
           position: relative;
           overflow: hidden;
           min-height: 80px;
       }

       .experience-card:hover {
           border-color: #10b981;
           background: rgba(16, 185, 129, 0.05);
           transform: translateY(-2px);
       }

       .experience-card.selected {
           border-color: #10b981;
           background: rgba(16, 185, 129, 0.08);
       }

       .experience-card.selected::after {
           content: '✓';
           position: absolute;
           top: 6px;
           right: 6px;
           width: 20px;
           height: 20px;
           background: #10b981;
           color: white;
           border-radius: 50%;
           display: flex;
           align-items: center;
           justify-content: center;
           font-size: 12px;
       }

       .experience-icon {
           font-size: 1.6rem;
           margin-bottom: 6px;
       }

       .experience-years {
           font-size: 0.85rem;
           font-weight: 600;
           color: #1e293b;
           margin-bottom: 3px;
       }

       .experience-label {
           font-size: 0.75rem;
           color: #64748b;
       }

       .experience-card input[type="radio"] {
           display: none;
       }

       .result-wrapper {
           background: #ffffff;
           height: 100vh;
           height: 100dvh;
           display: none;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           padding: 16px;
           overflow: hidden;
           position: fixed;
           top: 0;
           left: 0;
           right: 0;
           bottom: 0;
       }

       .result-wrapper .container {
           width: 100%;
           max-width: 480px;
           animation: fadeIn 0.5s ease;
       }

       @keyframes fadeIn {
           from { opacity: 0; transform: translateY(20px); }
           to { opacity: 1; transform: translateY(0); }
       }

       .result-wrapper .header-title {
           text-align: center;
           color: #1e293b;
           font-size: 1.5rem;
           font-weight: 700;
           margin-bottom: 24px;
           line-height: 1.2;
           transition: all 0.4s ease;
       }

       .progress-card {
           background: white;
           border-radius: 16px;
           padding: 24px 20px;
           box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
           border: 2px solid #e5e7eb;
           position: relative;
           transition: all 0.4s ease;
       }

       .progress-card.hidden {
           opacity: 0;
           transform: scale(0.95);
           pointer-events: none;
       }

       .progress-header {
           margin-bottom: 20px;
       }

       .progress-percentage {
           font-size: 2.2rem;
           font-weight: 700;
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           margin-bottom: 6px;
       }

       .progress-subtitle {
           color: #64748b;
           font-size: 0.9rem;
       }

       .progress-bar-container {
           height: 6px;
           background: #e5e7eb;
           border-radius: 100px;
           overflow: hidden;
           margin-bottom: 24px;
           position: relative;
       }

       .progress-bar-fill {
           height: 100%;
           background: linear-gradient(90deg, #10b981 0%, #059669 100%);
           border-radius: 100px;
           width: 0%;
           transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
           position: relative;
           overflow: hidden;
       }

       .progress-bar-fill::after {
           content: '';
           position: absolute;
           top: 0;
           left: 0;
           right: 0;
           bottom: 0;
           background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
           animation: shimmer 2s infinite;
       }

       @keyframes shimmer {
           0% { transform: translateX(-100%); }
           100% { transform: translateX(100%); }
       }

       .checklist {
           display: flex;
           flex-direction: column;
           gap: 12px;
           margin-bottom: 20px;
       }

       .checklist-item {
           display: flex;
           align-items: center;
           gap: 10px;
           opacity: 0.5;
           transition: opacity 0.3s ease;
       }

       .checklist-item.active {
           opacity: 1;
       }

       .checklist-icon {
           width: 20px;
           height: 20px;
           border: 2px solid #e5e7eb;
           border-radius: 50%;
           display: flex;
           align-items: center;
           justify-content: center;
           transition: all 0.3s ease;
           flex-shrink: 0;
       }

       .checklist-item.completed .checklist-icon {
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           border-color: transparent;
       }

       .checklist-icon svg {
           width: 12px;
           height: 12px;
           stroke: white;
           stroke-width: 3;
           fill: none;
           opacity: 0;
           transform: scale(0);
           transition: all 0.3s ease;
       }

       .checklist-item.completed .checklist-icon svg {
           opacity: 1;
           transform: scale(1);
       }

       .checklist-text {
           color: #334155;
           font-size: 0.85rem;
           font-weight: 500;
           line-height: 1.2;
       }

       .testimonial-card {
           background: #f8fafc;
           border-radius: 10px;
           padding: 12px;
           display: flex;
           gap: 10px;
           align-items: flex-start;
           margin-top: 16px;
           border: 1px solid #e5e7eb;
       }

       .testimonial-avatar {
           width: 36px;
           height: 36px;
           border-radius: 50%;
           background: linear-gradient(135deg, #a78bfa 0%, #7c3aed 100%);
           display: flex;
           align-items: center;
           justify-content: center;
           color: white;
           font-weight: 600;
           flex-shrink: 0;
           font-size: 0.8rem;
       }

       .testimonial-content {
           flex: 1;
       }

       .testimonial-header {
           display: flex;
           justify-content: flex-start;
           align-items: center;
           gap: 4px;
           margin-bottom: 3px;
       }

       .testimonial-name {
           font-weight: 600;
           color: #1e293b;
           font-size: 0.85rem;
       }

       .testimonial-stars {
           color: #fbbf24;
           font-size: 0.8rem;
       }

       .testimonial-text {
           color: #64748b;
           font-size: 0.8rem;
           line-height: 1.3;
       }

       .success-card {
           background: white;
           border-radius: 16px;
           padding: 32px 24px;
           box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
           border: 2px solid #e5e7eb;
           text-align: center;
           display: none;
           animation: successPop 0.5s ease;
       }

       .success-card.visible {
           display: block;
       }

       @keyframes successPop {
           0% {
               opacity: 0;
               transform: scale(0.8);
           }
           50% {
               transform: scale(1.05);
           }
           100% {
               opacity: 1;
               transform: scale(1);
           }
       }

       .success-count {
           font-size: 2.5rem;
           font-weight: 800;
           background: linear-gradient(135deg, #10b981 0%, #059669 100%);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           margin: 12px 0;
       }

       .success-description {
           color: #94a3b8;
           font-size: 0.85rem;
           margin-bottom: 24px;
       }

       .loading-dots {
           display: inline-block;
       }

       .loading-dots::after {
           content: '';
           animation: dots 2s steps(4, end) infinite;
       }

       @keyframes dots {
           0% { content: ''; }
           25% { content: '.'; }
           50% { content: '..'; }
           75% { content: '...'; }
           100% { content: ''; }
       }

       @media (max-height: 600px) {
           .app-header { padding: 8px 12px; height: 40px; }
           .question-header { margin-bottom: 12px; }
           .question-title { font-size: 1.1rem; }
           .question-subtitle { font-size: 0.8rem; }
           .option-card { padding: 10px 12px; min-height: 42px; }
           .app-footer { padding: 10px 14px; }
           .continue-button { height: 40px; font-size: 15px; }
           .experience-card { min-height: 70px; padding: 10px; }
           .info-illustration {
               width: min(224px, 25vh);
               height: min(224px, 25vh);
               font-size: min(7rem, 18vh);
           }
           .country-image {
               width: min(224px, 25vh);
               height: min(224px, 25vh);
           }
       }

       @media (max-height: 500px) {
           .option-card { padding: 8px 10px; min-height: 38px; }
           .option-text { font-size: 0.85rem; }
           .histogram-bars { height: 80px; }
           .experience-icon { font-size: 1.4rem; }
           .success-icon { width: 60px; height: 60px; font-size: 30px; }
       }

#info-summary {
    justify-content: flex-start;
}

#info-summary .info-illustration {
    width: min(200px, 22vh);
    height: min(200px, 22vh);
    font-size: min(6rem, 18vh);
}

#info-summary .experience-cards {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 8px;
}

#info-summary .experience-card {
    padding: 8px;
    min-height: 60px;
}

@media (max-width: 480px) {
    #info-summary {
        padding: 8px;
        gap: 8px;
    }

    #info-summary .info-illustration {
        width: min(160px, 18vh);
        height: min(160px, 18vh);
        font-size: min(5rem, 16vh);
    }

    #info-summary .experience-cards {
        grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
        gap: 6px;
        margin-bottom: 0;
    }

    #info-summary .experience-card {
        padding: 6px;
        min-height: 50px;
    }
}
   </style>
</head>
<body>
   <div class="app-container" id="quizApp">
       <!-- Header -->
       <div class="app-header">
           <button class="back-button" id="backBtn" onclick="changeQuestion(-1)" style="display: none;">
               <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                   <path d="M15 18l-6-6 6-6"/>
               </svg>
           </button>
            <div class="app-logo">Remoteurs.co</div>
           <div class="header-right">
               <div class="step-counter" id="stepIndicator">1/19</div>
               <button class="legal-toggle" id="legalToggle" type="button" aria-label="Informations légales" aria-expanded="false">?</button>
           </div>
           <div class="legal-dropdown" id="legalDropdown" role="group" aria-label="Informations légales" aria-hidden="true">
               <nav class="legal-dropdown-links" aria-label="Informations légales">
                   <a href="https://remoteurs.co/mentions-legales" target="_blank" rel="noopener">Mentions légales</a>
                   <span class="legal-separator" aria-hidden="true">·</span>
                   <a href="https://remoteurs.co/politique-de-confidentialite" target="_blank" rel="noopener">Confidentialité</a>
                   <span class="legal-separator" aria-hidden="true">·</span>
                   <a href="https://remoteurs.co/preferences-cookies" target="_blank" rel="noopener">Préférences cookies</a>
               </nav>
           </div>
       </div>

       <!-- Progress Bar -->
       <div class="progress-bar">
           <div class="progress-fill" id="progressBar" style="width: 5.3%"></div>
       </div>

       <!-- Content -->
       <div class="app-content">
           <!-- Question 1: expérience -->
           <div class="question-section active" id="question1">
               <div class="question-header">
                   <h2 class="question-title">Quelle est votre expérience ?</h2>
                   <p class="question-subtitle">Les entreprises recherchent activement des profils en télétravail. Nous vous connectons aux offres qui correspondent à votre parcours.</p>
               </div>
               <div class="experience-cards">
                   <label class="experience-card">
                       <input type="radio" name="experience" value="premier">
                       <div class="experience-icon">🌱</div>
                       <div class="experience-years">Premier emploi</div>
                       <div class="experience-label">&nbsp;</div>
                   </label>
                   <label class="experience-card">
                       <input type="radio" name="experience" value="moins1">
                       <div class="experience-icon">💡</div>
                       <div class="experience-years">Moins d'1 an</div>
                       <div class="experience-label">d'expérience</div>
                   </label>
                   <label class="experience-card">
                       <input type="radio" name="experience" value="1-2">
                       <div class="experience-icon">💼</div>
                       <div class="experience-years">1-2 ans</div>
                       <div class="experience-label">d'expérience</div>
                   </label>
                   <label class="experience-card">
                       <input type="radio" name="experience" value="3-5">
                       <div class="experience-icon">💎</div>
                       <div class="experience-years">3-5 ans</div>
                       <div class="experience-label">d'expérience</div>
                   </label>
                   <label class="experience-card">
                       <input type="radio" name="experience" value="6+">
                       <div class="experience-icon">👑</div>
                       <div class="experience-years">6+ ans</div>
                       <div class="experience-label">d'expérience</div>
                   </label>
               </div>
           </div>

           <!-- Info screens after question 1 -->
         <div class="info-screen" id="info-premier">
             <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a83cc186582_debutgro-min.png" alt="Illustration" /></div>
              <h2 class="info-title">Bienvenue</h2>
              <p class="info-text">
                  Vous débutez votre parcours professionnel. Nous identifions des opportunités adaptées aux premiers postes ; répondez à quelques questions et nous vous orienterons rapidement.
              </p>
          </div>

         <div class="info-screen" id="info-moins1">
             <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a83cc186582_debutgro-min.png" alt="Illustration" /></div>
              <h2 class="info-title">Bon timing</h2>
              <p class="info-text">
                  Avec moins d’un an d’expérience, de nombreuses équipes recrutent des profils à fort potentiel. En deux minutes, nous ciblons des offres pour accélérer votre progression.
              </p>
          </div>

         <div class="info-screen" id="info-1-2">
             <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a83cc186582_debutgro-min.png" alt="Illustration" /></div>
              <h2 class="info-title">Position favorable</h2>
              <p class="info-text">
                  Avec 1–2 ans d’expérience, vous avez déjà des résultats à valoriser. Nous sélectionnons des missions concrètes où vous pourrez monter en responsabilité.
              </p>
          </div>

         <div class="info-screen" id="info-3-5">
             <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a83cc186582_debutgro-min.png" alt="Illustration" /></div>
              <h2 class="info-title">Très recherché</h2>
              <p class="info-text">
                  Avec 3–5 ans d’expérience, l’autonomie et l’impact sont attendus. Nous visons des environnements où vous délivrerez rapidement des résultats mesurables.
              </p>
          </div>

         <div class="info-screen" id="info-6plus">
             <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a83cc186582_debutgro-min.png" alt="Illustration" /></div>
              <h2 class="info-title">Expert confirmé</h2>
              <p class="info-text">
                  Avec plus de 6 ans d’expérience, vous pilotez des périmètres et accompagnez des équipes. Nous proposons des postes à responsabilité en phase avec votre expertise.
              </p>
          </div>

           <!-- Reviews screen -->
           <div class="reviews-screen" id="reviews-screen">
               <h2 class="reviews-title">Ce que nos utilisateurs disent</h2>

               <div class="reviews-container">
                   <div class="review-card">
                       <div class="review-header">
                           <span class="review-author">Marie L.</span>
                           <span class="review-stars">★★★★★</span>
                       </div>
                       <p class="review-text">"J'ai trouvé mon job en télétravail en moins de 3 semaines ! Les offres sont vraiment qualifiées et correspondent exactement à ce que je cherchais."</p>
                   </div>

                   <div class="review-card">
                       <div class="review-header">
                           <span class="review-author">Thomas D.</span>
                           <span class="review-stars">★★★★★</span>
                       </div>
                       <p class="review-text">"Enfin une plateforme qui comprend les besoins des profils en remote. Fini les fausses annonces, ici tout est vérifié."</p>
                   </div>

                   <div class="review-card">
                       <div class="review-header">
                           <span class="review-author">Sophie M.</span>
                           <span class="review-stars">★★★★★</span>
                       </div>
                       <p class="review-text">"Le matching est impressionnant. Je ne reçois que des offres pertinentes, ça me fait gagner un temps fou !"</p>
                   </div>
               </div>

               <img class="trustpilot-placeholder" src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68ad78183f2f3_reviews-min.png" alt="Avis Trustpilot">
           </div>

           <!-- Question 2: Niveau -->
           <div class="question-section" id="question2">
               <div class="question-header">
                   <h2 class="question-title">Comment qualifieriez-vous votre niveau ?</h2>
                   <p class="question-subtitle">Soyez honnête, cela nous aide à mieux cibler</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="niveau" value="debutant">
                           <span class="option-text">Débutant</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="niveau" value="junior">
                           <span class="option-text">Junior (&lt;2 ans)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="niveau" value="confirme">
                           <span class="option-text">Confirmé (2-4 ans)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="niveau" value="senior">
                           <span class="option-text">Senior (5+ ans)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="niveau" value="lead">
                           <span class="option-text">Lead/Manager</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="niveau" value="direction">
                           <span class="option-text">Direction</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 3: Niveau d'études -->
           <div class="question-section" id="question3">
               <div class="question-header">
                   <h2 class="question-title">Niveau d'études</h2>
                   <p class="question-subtitle">Votre diplôme le plus élevé obtenu</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="etudes" value="sans-diplome">
                           <span class="option-text">Sans diplôme</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="bac">
                           <span class="option-text">Bac</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="bac+2">
                           <span class="option-text">Bac+2 (BTS/DUT)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="bac+3">
                           <span class="option-text">Licence (Bac+3)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="bac+5">
                           <span class="option-text">Master (Bac+5)</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="grande-ecole">
                           <span class="option-text">Diplôme grande école</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="etudes" value="doctorat">
                           <span class="option-text">Doctorat (PhD)</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 4: Niveau d'anglais -->
           <div class="question-section" id="question4">
               <div class="question-header">
                   <h2 class="question-title">Niveau d'anglais (CECRL)</h2>
                   <p class="question-subtitle">Important pour les offres internationales</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="anglais" value="A1">
                           <span class="option-text">A1 - Débutant<span class="option-subtext">Mots simples, phrases basiques</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="A2">
                           <span class="option-text">A2 - Élémentaire<span class="option-subtext">Conversations simples du quotidien</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="B1">
                           <span class="option-text">B1 - Intermédiaire<span class="option-subtext">Voyager, sujets familiers</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="B2">
                           <span class="option-text">B2 - Avancé<span class="option-subtext">Travail en anglais, discussions techniques</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="C1">
                           <span class="option-text">C1 - Autonome<span class="option-subtext">Présentation, négociation, nuances</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="C2">
                           <span class="option-text">C2 - Maîtrise<span class="option-subtext">Niveau quasi-natif, toutes situations</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="anglais" value="natif">
                           <span class="option-text">Locuteur natif</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Info recap (après Q4) -->
           <div class="info-screen" id="info-summary">
               <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a849711fd43_entendufor.png" alt="Illustration" /></div>
               <h2 class="info-title">On vous a compris !</h2>
               <p class="info-text">
                   Voici comment vos réponses vous avantagent pour décrocher <strong>les meilleures offres remote</strong>.
               </p>
               
               <div class="experience-cards" style="margin-top: 20px;">
                   <div class="experience-card" style="pointer-events: none;">
                       <div class="experience-icon">😎</div>
                       <div class="experience-years" id="sum-exp-title">Intermédiaire</div>
                       <div class="experience-label" id="sum-exp-text">Beaucoup d'équipes encadrent les profils en montée en compétence.</div>
                   </div>
                   
                   <div class="experience-card" style="pointer-events: none;">
                       <div class="experience-icon">👍</div>
                       <div class="experience-years" id="sum-degree-title">Master / Grande École</div>
                       <div class="experience-label" id="sum-degree-text">Vous êtes dans les profils les plus qualifiés.</div>
                   </div>
                   
                   <div class="experience-card" style="pointer-events: none;">
                       <div class="experience-icon">🎯</div>
                       <div class="experience-years" id="sum-en-title">Anglais B1</div>
                       <div class="experience-label" id="sum-en-text">On priorisera d'abord les offres FR/UE adaptées.</div>
                   </div>
               </div>
           </div>

           <!-- Question 5: Type de contrat -->
           <div class="question-section" id="question5">
               <div class="question-header">
                   <h2 class="question-title">Type de contrat</h2>
                   <p class="question-subtitle">Sélectionnez tous ceux qui vous intéressent</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="checkbox" name="contrat" value="cdi">
                           <span class="option-text">CDI</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="contrat" value="cdd">
                           <span class="option-text">CDD</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="contrat" value="freelance">
                           <span class="option-text">Freelance/Indépendant</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="contrat" value="stage">
                           <span class="option-text">Stage/Alternance</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="contrat" value="benevolat">
                           <span class="option-text">Bénévolat</span>
                       </label>
                   </div>
               </div>
           </div>

           <div class="info-screen" id="info-contrat">
               <div class="info-illustration"><img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a92d7f36429_ckilvoufaut-min.png" alt="Illustration" /></div>
               <h2 class="info-title">On a ce qu'il vous faut !</h2>
               <p class="info-text" id="contractInfoText"></p>
           </div>

           <!-- Question 6: Disponibilité -->
           <div class="question-section" id="question6">
               <div class="question-header">
                   <h2 class="question-title">Quand pouvez-vous commencer ?</h2>
                   <p class="question-subtitle">Pour adapter les offres à votre timeline</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="disponibilite" value="immediatement">
                           <span class="option-text">Immédiatement</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="disponibilite" value="1-semaine">
                           <span class="option-text">1 semaine</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="disponibilite" value="2-semaines">
                           <span class="option-text">2 semaines</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="disponibilite" value="1-mois">
                           <span class="option-text">1 mois</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="disponibilite" value="plus-tard">
                           <span class="option-text">Plus tard (>1 mois)</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 7: Temps pour candidatures -->
           <div class="question-section" id="question7">
               <div class="question-header">
                   <h2 class="question-title">Temps dispo pour candidatures</h2>
                   <p class="question-subtitle">Pour adapter le volume d'offres envoyées</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="temps" value="tres-peu">
                           <span class="option-text">Très peu</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="temps" value="10-30min">
                           <span class="option-text">10-30 min/j</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="temps" value="30-60min">
                           <span class="option-text">30-60 min/j</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="temps" value="1-2h">
                           <span class="option-text">1-2 h/j</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="temps" value="2-4h">
                           <span class="option-text">2-4 h/j</span>
                       </label>
                   </div>
               </div>
           </div>

           <div class="info-screen" id="info-autoapply">
              <div class="info-illustration">
                  <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a80e7a10278_robot.png" alt="Robot IA">
              </div>
               <h2 class="info-title">Nouveau !</h2>
               <p class="info-text">
                   Essayez notre <strong>Postuleur automatique propulsé par l'IA</strong> pour envoyer
                   jusqu'à <strong>50 candidatures par jour</strong> en autopilote !
               </p>
           </div>

           <!-- Question 8: Pays de travail -->
           <div class="question-section" id="question8">
               <div class="question-header">
                   <h2 class="question-title">Dans quel pays travaillerez-vous ?</h2>
                   <p class="question-subtitle">Si vous êtes nomade digital, choisissez le pays où vous êtes imposé.</p>
               </div>
               <div class="options-scroll-container">
                   <div class="select-wrapper">
                       <select id="countrySelect" name="pays" class="select-country"></select>
                   </div>
                   <img src="https://d1yei2z3i6k35z.cloudfront.net/13114230/68a8193dd51d7_terre.png" alt="Planète Terre" class="country-image">
               </div>
           </div>

           <!-- Question 9: Types d'offres -->
           <div class="question-section" id="question9">
               <div class="question-header">
                   <h2 class="question-title">Types d'offres souhaitées</h2>
                   <p class="question-subtitle">Sélectionnez tous ceux qui vous conviennent</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="checkbox" name="type-offres" value="100-remote">
                           <span class="option-text">100 % télétravail<span class="option-subtext">N'importe où</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="type-offres" value="remote-pays">
                           <span class="option-text">Télétravail (votre pays)<span class="option-subtext">ex. France uniquement</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="type-offres" value="hybride">
                           <span class="option-text">Hybride<span class="option-subtext">Présence ponctuelle au bureau</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="type-offres" value="sur-site">
                           <span class="option-text">Sur site<span class="option-subtext">Présence au bureau</span></span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 10: Catégories métiers -->
           <div class="question-section" id="question10">
               <div class="question-header">
                   <h2 class="question-title">Catégories métiers</h2>
                   <p class="question-subtitle">Sélectionnez toutes les catégories qui vous intéressent</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container two-columns">
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="design">
                           <span class="option-text">🎨 Design</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="education">
                           <span class="option-text">🎓 Éducation</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="entry-level">
                           <span class="option-text">🐣 Débutant / Premier emploi</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="healthcare">
                           <span class="option-text">🩺 Santé</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="hr-recruitment">
                           <span class="option-text">👥 RH &amp; Recrutement</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="it-software">
                           <span class="option-text">💻 IT &amp; Logiciels</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="legal">
                           <span class="option-text">⚖️ Juridique</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="marketing-pr">
                           <span class="option-text">📣 Marketing &amp; RP</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="operations">
                           <span class="option-text">⚙️ Opérations</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="customer-service">
                           <span class="option-text">🤝 Service Client</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="supply-chain">
                           <span class="option-text">🚚 Supply Chain</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="sales-bizdev">
                           <span class="option-text">📈 Commercial &amp; BizDev</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="translation">
                           <span class="option-text">🌍 Traduction</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="travel-tourism">
                           <span class="option-text">✈️ Voyage &amp; Tourisme</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="research">
                           <span class="option-text">🔬 Recherche</span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="categories" value="finance-accounting">
                           <span class="option-text">💰 Finance &amp; Comptabilité</span>
                       </label>
                       <label class="option-card option-card--other">
                           <input type="checkbox" name="categories" value="other" id="categoriesOtherCheckbox">
                           <span class="option-text">
                               🧩 Autre (précisez)
                               <input type="text" id="categoriesOtherInput" class="option-other-input" placeholder="Votre catégorie idéale">
                           </span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 11: Améliorer correspondances (optionnel) -->
           <div class="question-section" id="question11">
               <div class="question-header">
                   <h2 class="question-title">Améliorer vos correspondances</h2>
                   <p class="question-subtitle">Facultatif - Importez votre CV pour un matching plus précis</p>
               </div>
               <div class="options-scroll-container">
                   <div class="file-upload" onclick="document.getElementById('cv-upload').click()" id="cv-upload-container">
                       <input type="file" id="cv-upload" accept=".pdf,.doc,.docx" onchange="handleCvUpload(event)">
                       <div class="file-upload-content">
                           <div class="file-upload-icon">⬆️</div>
                           <p class="file-upload-text">Cliquez pour importer votre CV</p>
                           <p class="file-upload-subtext">PDF, DOC ou DOCX acceptés</p>
                       </div>
                       <div class="uploaded-file">
                           <span class="uploaded-file-name"></span>
                           <span class="remove-file" onclick="removeCvFile(event)">✕</span>
                       </div>
                   </div>
                   <p class="cv-reminder">Si vous n'avez pas votre CV sous la main, vous pourrez l'importer plus tard depuis votre espace personnel.</p>
                   <div class="skip-link">
                       <a href="#" onclick="skipQuestion(event)">Passer cette étape →</a>
                   </div>
               </div>
           </div>

           <!-- Question 12: Rémunération cible -->
           <div class="question-section" id="question12">
               <div class="question-header">
                   <h2 class="question-title">Fourchette de salaire brut</h2>
                   <p class="question-subtitle">Affinez pour ne voir que les offres dans votre plage</p>
               </div>
               <div class="options-scroll-container">
                   <div class="salary-tabs" id="salaryTabs" role="tablist">
                       <button class="salary-tab" role="tab" data-period="horaire" aria-selected="false">Horaire</button>
                       <button class="salary-tab active" role="tab" data-period="mensuel" aria-selected="true">Mensuel</button>
                       <button class="salary-tab" role="tab" data-period="annuel" aria-selected="false">Annuel</button>
                   </div>
                   <div class="histogram-container">
                       <div class="histogram-bars" id="histogramBars"></div>
                       <div class="range-track" id="rangeTrack">
                           <div class="range-line"></div>
                           <div id="minHandle" class="handle" tabindex="0" role="slider" aria-label="Minimum"></div>
                           <div id="maxHandle" class="handle" tabindex="0" role="slider" aria-label="Maximum"></div>
                       </div>
                   </div>
                   <div class="salary-inputs">
                       <div class="salary-input">
                           <label for="salaryMin">Min</label>
                           <div class="input-wrapper">
                               <input type="text" id="salaryMin">
                               <span id="unitMin">€/mois</span>
                           </div>
                       </div>
                       <div class="salary-input">
                           <label for="salaryMax">Max</label>
                           <div class="input-wrapper">
                               <input type="text" id="salaryMax">
                               <span id="unitMax">€/mois</span>
                           </div>
                       </div>
                   </div>
               </div>
           </div>
           
           <!-- Question 13: Emploi du temps -->
           <div class="question-section" id="question13">
               <div class="question-header">
                   <h2 class="question-title">Votre emploi du temps idéal</h2>
                   <p class="question-subtitle">Comment préférez-vous organiser votre journée</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="rythme" value="horaires-flexibles">
                           <span class="option-text">Horaires flexibles<span class="option-subtext">Je préfère organiser le travail autour de ma vie.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="rythme" value="9h-17h">
                           <span class="option-text">9 h–17 h<span class="option-subtext">Je préfère un horaire fixe chaque jour.</span></span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 14: Configuration d'équipe -->
           <div class="question-section" id="question14">
               <div class="question-header">
                   <h2 class="question-title">Configuration d'équipe idéale</h2>
                   <p class="question-subtitle">Dans quel contexte performez-vous le mieux</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="checkbox" name="equipe" value="grande">
                           <span class="option-text">Grande équipe<span class="option-subtext">Collaboration, diversité, réseau.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="equipe" value="petite">
                           <span class="option-text">Petite équipe<span class="option-subtext">Décisions rapides, communication simple.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="equipe" value="independant">
                           <span class="option-text">Indépendant<span class="option-subtext">Autonomie, responsabilité.</span></span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 15: Taille d'entreprise -->
           <div class="question-section" id="question15">
               <div class="question-header">
                   <h2 class="question-title">Taille d'entreprise préférée</h2>
                   <p class="question-subtitle">Quel environnement préférez-vous</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="checkbox" name="taille" value="startup">
                           <span class="option-text">Start-up<span class="option-subtext">Innovation et croissance rapide.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="taille" value="pme">
                           <span class="option-text">PME<span class="option-subtext">Équilibre stabilité et évolution.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="checkbox" name="taille" value="grand-groupe">
                           <span class="option-text">Grand groupe<span class="option-subtext">Stabilité et parcours structurés.</span></span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 16: Priorité du moment -->
           <div class="question-section" id="question16">
               <div class="question-header">
                   <h2 class="question-title">Votre priorité du moment</h2>
                   <p class="question-subtitle">Ce qui compte le plus pour vous actuellement</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="priorite" value="equilibre">
                           <span class="option-text">Équilibre vie pro/perso<span class="option-subtext">J'ai d'autres priorités et je veux un vrai équilibre.</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="priorite" value="progression">
                           <span class="option-text">Progression professionnelle<span class="option-subtext">Gagner en expérience et évoluer.</span></span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 17: Société immatriculée -->
           <div class="question-section" id="question17">
               <div class="question-header">
                   <h2 class="question-title">Avez-vous une société immatriculée ?</h2>
                   <p class="question-subtitle">Pour les offres freelance uniquement</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="freelance-statut" value="oui">
                           <span class="option-text">Oui</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="freelance-statut" value="non">
                           <span class="option-text">Non</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="freelance-statut" value="envisage">
                           <span class="option-text">J'envisage d'en créer une</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 18: Équipe actuelle -->
           <div class="question-section" id="question18">
               <div class="question-header">
                   <h2 class="question-title">Avez-vous déjà une équipe ?</h2>
                   <p class="question-subtitle">Pour les postes managériaux</p>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="management" value="oui">
                           <span class="option-text">Oui</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="management" value="non">
                           <span class="option-text">Non</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="management" value="envisage">
                           <span class="option-text">J'envisage d'en constituer une</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Question 19: Source de découverte -->
           <div class="question-section" id="question19">
               <div class="question-header">
                   <h2 class="question-title">Où avez-vous entendu parler de Remoteurs.co&nbsp;?</h2>
               </div>
               <div class="options-scroll-container">
                   <div class="options-container">
                       <label class="option-card">
                           <input type="radio" name="discovery" value="television">
                           <span class="option-text">Télévision<span class="option-subtext">ex : TF1, France 2, BFM Business</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="radio">
                           <span class="option-text">Radio nationale<span class="option-subtext">ex : France Inter, RTL, Europe 1</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="social-ad">
                           <span class="option-text">Pub sur un réseau social</span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="presse-secteur">
                           <span class="option-text">Presse de mon secteur<span class="option-subtext">ex : L’Usine Nouvelle, Stratégies</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="conference">
                           <span class="option-text">Conférence / salon pro<span class="option-subtext">ex : VivaTech</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="professionnel">
                           <span class="option-text">Recommandation d’un professionnel<span class="option-subtext">expert-comptable, avocat, notaire</span></span>
                       </label>
                       <label class="option-card">
                           <input type="radio" name="discovery" value="ami">
                           <span class="option-text">Recommandation d'un ami</span>
                       </label>
                   </div>
               </div>
           </div>

           <!-- Success -->
           <div class="success-section" id="successSection" style="display: none;">
               <div class="success-icon">✔</div>
               <h2 class="success-title">C'est fait ! Votre profil est créé 🎉</h2>
               <p class="success-text">Nous analysons vos réponses et nous vous envoyons les premières offres personnalisées dans quelques minutes.</p>
               <p class="success-tip">💡 Astuce : Activez les notifications pour ne rater aucune opportunité</p>
           </div>
       </div>

       <!-- Footer -->
       <div class="app-footer" id="appFooter">
           <button class="continue-button" id="nextBtn" onclick="changeQuestion(1)">Continuer</button>
           <nav class="legal-links" id="legalLinks" aria-label="Informations légales">
               <a href="https://remoteurs.co/mentions-legales" target="_blank" rel="noopener">Mentions légales</a>
               <span class="legal-separator" aria-hidden="true">·</span>
               <a href="https://remoteurs.co/politique-de-confidentialite" target="_blank" rel="noopener">Confidentialité</a>
               <span class="legal-separator" aria-hidden="true">·</span>
               <a href="https://remoteurs.co/preferences-cookies" target="_blank" rel="noopener">Préférences cookies</a>
           </nav>
       </div>
   </div>

   <div id="resultsWrapper" class="result-wrapper">
       <div class="container">
           <h1 class="header-title">Nous analysons les offres qui correspondent à votre profil<span class="loading-dots"></span></h1>

           <div class="progress-card" id="searchProgressCard">
               <div class="progress-header">
                   <div class="progress-percentage" id="searchProgressPercentage">0%</div>
                   <div class="progress-subtitle">Recherche en cours parmi nos partenaires</div>
               </div>

               <div class="progress-bar-container">
                   <div class="progress-bar-fill" id="searchProgressBar"></div>
               </div>

               <div class="checklist">
                   <div class="checklist-item" data-step="1">
                       <div class="checklist-icon">
                           <svg viewBox="0 0 24 24">
                               <polyline points="20 6 9 17 4 12"></polyline>
                           </svg>
                       </div>
                       <span class="checklist-text">Analyse de vos catégories et prétentions</span>
                   </div>
                   <div class="checklist-item" data-step="2">
                       <div class="checklist-icon">
                           <svg viewBox="0 0 24 24">
                               <polyline points="20 6 9 17 4 12"></polyline>
                           </svg>
                       </div>
                       <span class="checklist-text">Vérification de votre expérience</span>
                   </div>
                   <div class="checklist-item" data-step="3">
                       <div class="checklist-icon">
                           <svg viewBox="0 0 24 24">
                               <polyline points="20 6 9 17 4 12"></polyline>
                           </svg>
                       </div>
                       <span class="checklist-text">Compatibilité avec vos disponibilités</span>
                   </div>
                   <div class="checklist-item" data-step="4">
                       <div class="checklist-icon">
                           <svg viewBox="0 0 24 24">
                               <polyline points="20 6 9 17 4 12"></polyline>
                           </svg>
                       </div>
                       <span class="checklist-text">Filtrage par zone géographique</span>
                   </div>
                   <div class="checklist-item" data-step="5">
                       <div class="checklist-icon">
                           <svg viewBox="0 0 24 24">
                               <polyline points="20 6 9 17 4 12"></polyline>
                           </svg>
                       </div>
                       <span class="checklist-text">Calcul du score de compatibilité</span>
                   </div>
               </div>

               <div class="testimonial-card">
                   <div class="testimonial-avatar">JL</div>
                   <div class="testimonial-content">
                       <div class="testimonial-header">
                           <span class="testimonial-name">Julie L.</span>
                           <span class="testimonial-stars">★★★★★</span>
                       </div>
                       <p class="testimonial-text">"Grâce à ce matching personnalisé, j'ai trouvé mon CDI remote idéal en seulement 2 semaines !"</p>
                   </div>
               </div>
           </div>

           <div class="success-card" id="searchSuccessCard">
               <div class="success-icon">✔</div>
               <h2 class="success-title">Excellente nouvelle !</h2>
               <p class="success-subtitle">Nous avons trouvé</p>
               <div class="success-count">342</div>
               <p class="success-subtitle">offres 100% télétravail<br>qui correspondent à votre profil</p>
               <p class="success-description">Dont 47 avec le salaire affiché et 12 publiées aujourd'hui</p>
               <button class="continue-button" onclick="showEmailQuestion()">Voir mes offres personnalisées</button>
           </div>

          <div class="question-section" id="emailQuestion" style="display: none;">
              <div class="options-scroll-container">
                  <div id="sioEmailSlot" class="options-container">
                      <div id="sioEmailLoading" class="input-field" style="display:flex;align-items:center;justify-content:center;height:26.7px;">
                          Chargement du formulaire…
                      </div>
                  </div>
              </div>
              <div class="email-step-actions">
                  <button class="email-back-button" id="emailStepBack" type="button">Retour</button>
                  <button class="continue-button" type="button">Continuer</button>
              </div>
          </div>
       </div>
   </div>

   <script>
       const legalToggle = document.getElementById('legalToggle');
       const legalDropdown = document.getElementById('legalDropdown');
       const legalLinksFooter = document.getElementById('legalLinks');
       const legalDropdownLinks = legalDropdown ? legalDropdown.querySelector('.legal-dropdown-links') : null;
       if (legalLinksFooter && legalDropdownLinks) {
           legalDropdownLinks.innerHTML = legalLinksFooter.innerHTML;
       }

       if (legalToggle && legalDropdown) {
           const positionLegalDropdown = () => {
               if (legalToggle.offsetParent === null) {
                   return;
               }

               const header = legalToggle.closest('.app-header');
               if (!header) {
                   return;
               }

               let dropdownWidth = legalDropdown.offsetWidth;
               let needsRestore = false;

               if (!dropdownWidth) {
                   legalDropdown.style.visibility = 'hidden';
                   legalDropdown.style.display = 'block';
                   dropdownWidth = legalDropdown.offsetWidth;
                   needsRestore = true;
               }

               const toggleRect = legalToggle.getBoundingClientRect();
               const headerRect = header.getBoundingClientRect();
               const headerStyle = window.getComputedStyle(header);
               const paddingLeft = parseFloat(headerStyle.paddingLeft) || 0;
               const paddingRight = parseFloat(headerStyle.paddingRight) || 0;

               let left = toggleRect.left - headerRect.left;
               const maxLeft = headerRect.width - paddingRight - dropdownWidth;
               if (Number.isFinite(maxLeft)) {
                   left = Math.min(left, maxLeft);
               }
               left = Math.max(left, paddingLeft);

               const gap = 8;
               const top = toggleRect.bottom - headerRect.top + gap;

               legalDropdown.style.left = `${left}px`;
               legalDropdown.style.right = 'auto';
               legalDropdown.style.top = `${top}px`;
               legalDropdown.style.transform = 'none';

               if (needsRestore) {
                   legalDropdown.style.display = '';
                   legalDropdown.style.visibility = '';
               }
           };

           const closeLegalDropdown = (focusToggle = false) => {
               if (!legalDropdown.classList.contains('show')) {
                   return;
               }

               legalDropdown.classList.remove('show');
               legalToggle.setAttribute('aria-expanded', 'false');
               legalDropdown.setAttribute('aria-hidden', 'true');

               if (focusToggle && legalToggle.offsetParent !== null) {
                   legalToggle.focus();
               }
           };

           const openLegalDropdown = () => {
               positionLegalDropdown();
               legalDropdown.classList.add('show');
               legalToggle.setAttribute('aria-expanded', 'true');
               legalDropdown.setAttribute('aria-hidden', 'false');

               const firstLink = legalDropdown.querySelector('a');
               if (firstLink) {
                   firstLink.focus();
               }
           };

           legalToggle.addEventListener('click', (event) => {
               event.preventDefault();
               if (legalDropdown.classList.contains('show')) {
                   closeLegalDropdown(true);
               } else {
                   openLegalDropdown();
               }
           });

           document.addEventListener('click', (event) => {
               if (!legalDropdown.contains(event.target) && !legalToggle.contains(event.target)) {
                   closeLegalDropdown();
               }
           });

           document.addEventListener('keydown', (event) => {
               if (event.key === 'Escape' && legalDropdown.classList.contains('show')) {
                   closeLegalDropdown(true);
               }
           });

           window.addEventListener('resize', () => {
               if (window.matchMedia('(min-width: 600px)').matches) {
                   closeLegalDropdown();
               } else if (legalDropdown.classList.contains('show')) {
                   positionLegalDropdown();
               }
           });
       }

       // Variables
       let currentQuestion = 1;
       const totalQuestions = 19;
       const baseHeightsPct = [
           10, 14, 25, 50, 51, 54, 77, 87, 79, 80, 55, 47,
           26, 33, 24, 13, 9, 12, 10, 8, 7, 11, 6, 4
       ];
       let emailQuestionStep = 'identity';

       function toggleEmailStep(section, active) {
           if (!section) return;
           section.classList.add('email-step');
           if (active) {
               section.classList.add('active');
               section.style.animation = 'none';
               void section.offsetWidth;
               section.style.animation = 'slideIn 0.3s ease';
           } else {
               section.classList.remove('active');
               section.style.animation = '';
           }
       }

       function updateEmailStepDisplay() {
           const step = emailQuestionStep;
           const identitySection = document.getElementById('sioIdentitySection');
           const emailSection = document.getElementById('sioEmailSection');
           const continueBtn = document.querySelector('#emailQuestion .continue-button');
           const backBtn = document.getElementById('emailStepBack');

           toggleEmailStep(identitySection, step === 'identity');
           toggleEmailStep(emailSection, step === 'email');
           if (continueBtn) {
               continueBtn.textContent = step === 'email' ? 'Recevoir mes offres' : 'Continuer';
               continueBtn.dataset.step = step;
           }
           if (backBtn) {
               backBtn.style.display = step === 'email' ? 'flex' : 'none';
           }
       }

       function setEmailQuestionStep(step) {
           emailQuestionStep = step;
           updateEmailStepDisplay();
       }

       updateEmailStepDisplay();
       const salaryConfig = {
           horaire: {
               min: 3,
               max: 47,
               step: 1,
               unit: '€/h',
               heights: baseHeightsPct
           },
           mensuel: {
               min: 500,
               max: 7500,
               step: 50,
               unit: '€/mois',
               heights: baseHeightsPct
           },
           annuel: {
               min: 6000,
               max: 90000,
               step: 1000,
               unit: '€/an',
               heights: baseHeightsPct
           }
       };

       function convertFromMonthly(value, period) {
           if (period === 'horaire') return value / 160;
           if (period === 'annuel') return value * 12;
           return value;
       }

       function convertToMonthly(value, period) {
           if (period === 'horaire') return value * 160;
           if (period === 'annuel') return value / 12;
           return value;
       }

       Object.values(salaryConfig).forEach(cfg => {
           const range = cfg.max - cfg.min;
           const bin = range / 24;
           cfg.bin = bin;
           cfg.centers = Array.from({ length: 24 }, (_, i) => cfg.min + bin * (i + 0.5));
       });

       let salaryData = { period: 'mensuel', min: 1500, max: 5500, currency: 'EUR' };
       let canonical = { min: salaryData.min, max: salaryData.max };
       let salaryInitialized = false;
       let plotArea = { left: 0, right: 0, width: 0 };
       let rMin = 0;
       let rMax = 1;
       let activeHandle = null;
       let dragOffset = 0;
       let resizeObserver = null;
       const categorySalaryMap = {
           'it-software': { mensuel: { min: 2500, max: 6500 } },
           'marketing-pr': { mensuel: { min: 2000, max: 5000 } }
       };
       let infoNextQuestion = null;
       let lastInfoScreen = null;
       let hasShownReviews = false;
       let reviewNextQuestion = null;

       // Removed category modal logic

       // Initialize
       function updateExperienceSelection() {
           const checked = document.querySelector('input[name="experience"]:checked');
           document.querySelectorAll('.experience-card').forEach(card => {
               card.classList.toggle('selected', card.contains(checked));
           });
       }

       document.querySelectorAll('input[name="experience"]').forEach(input => {
           input.addEventListener('change', updateExperienceSelection);
       });
       updateExperienceSelection();


       // Populate country dropdown
       const countrySelect = document.getElementById('countrySelect');
       if (countrySelect) {
           const regionNamesInFrench = typeof Intl.DisplayNames === 'function'
               ? new Intl.DisplayNames(['fr'], { type: 'region' })
               : null;

           const getCountryName = code => regionNamesInFrench ? regionNamesInFrench.of(code) : code;

           const fallbackCountryCodes = [
               "AF","AX","AL","DZ","AS","AD","AO","AI","AQ","AG","AR","AM","AW","AU","AT","AZ",
               "BS","BH","BD","BB","BY","BE","BZ","BJ","BM","BT","BO","BQ","BA","BW","BV","BR",
               "IO","BN","BG","BF","BI","KH","CM","CA","CV","KY","CF","TD","CL","CN","CX","CC",
               "CO","KM","CG","CD","CK","CR","CI","HR","CU","CW","CY","CZ","DK","DJ","DM","DO",
               "EC","EG","SV","GQ","ER","EE","ET","FK","FO","FJ","FI","FR","GF","PF","TF","GA",
               "GM","GE","DE","GH","GI","GR","GL","GD","GP","GU","GT","GG","GN","GW","GY","HT",
               "HM","VA","HN","HK","HU","IS","IN","ID","IR","IQ","IE","IM","IL","IT","JM","JP",
               "JE","JO","KZ","KE","KI","KP","KR","KW","KG","LA","LV","LB","LS","LR","LY","LI",
               "LT","LU","MO","MK","MG","MW","MY","MV","ML","MT","MH","MQ","MR","MU","YT","MX",
               "FM","MD","MC","MN","ME","MS","MA","MZ","MM","NA","NR","NP","NL","NC","NZ","NI",
               "NE","NG","NU","NF","MP","NO","OM","PK","PW","PS","PA","PG","PY","PE","PH","PN",
               "PL","PT","PR","QA","RE","RO","RU","RW","BL","SH","KN","LC","MF","PM","VC","WS",
               "SM","ST","SA","SN","RS","SC","SL","SG","SX","SK","SI","SB","SO","ZA","GS","SS",
               "ES","LK","SD","SR","SJ","SZ","SE","CH","SY","TW","TJ","TZ","TH","TL","TG","TK",
               "TO","TT","TN","TR","TM","TC","TV","UG","UA","AE","GB","US","UM","UY","UZ","VU",
               "VE","VN","VG","VI","WF","EH","YE","ZM","ZW"
           ];

           let countryCodes;
           if (typeof Intl.supportedValuesOf === 'function') {
               try {
                   countryCodes = Intl.supportedValuesOf('region').filter(code => /^[A-Z]{2}$/i.test(code));
               } catch (err) {
                   countryCodes = fallbackCountryCodes;
               }
           } else {
               countryCodes = fallbackCountryCodes;
           }

           countryCodes.forEach(code => {
               const codeUpper = code.toUpperCase();
               const option = document.createElement('option');
               const flag = codeUpper
                   .split('')
                   .map(char => String.fromCodePoint(127397 + char.charCodeAt()))
                   .join('');
               option.value = codeUpper;
               option.textContent = `${flag} ${getCountryName(codeUpper)}`;
               countrySelect.appendChild(option);
           });

           countrySelect.value = 'FR';
       }

       // Handle option card selection
       document.querySelectorAll('.option-card').forEach(card => {
           const container = card.parentElement;
           const input = card.querySelector('input[type="radio"], input[type="checkbox"]');

           if (input && container) {
               input.addEventListener('change', () => updateCardSelection(container));
           }

           card.addEventListener('click', function(e) {
               const cardInput = this.querySelector('input[type="radio"], input[type="checkbox"]');
               if (!cardInput) return;

               const isTextInput = e.target instanceof HTMLInputElement && e.target.type === 'text';
               if (isTextInput) {
                   return;
               }

               if (e.target !== cardInput) {
                   e.preventDefault();

                   if (cardInput.type === 'checkbox') {
                       cardInput.checked = !cardInput.checked;
                   } else {
                       cardInput.checked = true;
                   }

                   cardInput.dispatchEvent(new Event('change', { bubbles: true }));
               }

               updateCardSelection(this.parentElement);
           });
       });

       function updateCardSelection(container) {
           container.querySelectorAll('.option-card').forEach(card => {
               const input = card.querySelector('input[type="radio"], input[type="checkbox"]');
               if (input && input.checked) {
                   card.classList.add('selected');
               } else {
                   card.classList.remove('selected');
               }
           });
       }

       const scrollIndicatorRegistry = new Map();

       function attachScrollIndicator(container) {
           if (!container || scrollIndicatorRegistry.has(container)) return;

           const wrapper = document.createElement('div');
           wrapper.className = 'scroll-container-wrapper';
           container.parentNode.insertBefore(wrapper, container);
           wrapper.appendChild(container);

           let indicator = container.querySelector('.scroll-indicator');
           if (indicator) {
               indicator.remove();
           } else {
               indicator = document.createElement('div');
               indicator.className = 'scroll-indicator';
               indicator.setAttribute('aria-hidden', 'true');
               indicator.innerHTML = '<span>↓</span>';
           }
           wrapper.appendChild(indicator);

           const update = () => {
               const { scrollHeight, clientHeight, scrollTop } = container;
               const hasOverflow = scrollHeight - clientHeight > 1;
               const atBottom = scrollTop + clientHeight >= scrollHeight - 1;
               if (!hasOverflow || atBottom) {
                   indicator.classList.add('hidden');
               } else {
                   indicator.classList.remove('hidden');
               }
           };

           container.addEventListener('scroll', update, { passive: true });
           window.addEventListener('resize', update);
           let resizeObserver;
           if (typeof ResizeObserver === 'function') {
               resizeObserver = new ResizeObserver(() => update());
               resizeObserver.observe(container);
           }
           scrollIndicatorRegistry.set(container, { indicator, update, resizeObserver });
           requestAnimationFrame(update);
       }

       function updateScrollIndicator(container) {
           const entry = scrollIndicatorRegistry.get(container);
           if (!entry) return;
           entry.update();
       }

       function updateAllScrollIndicators() {
           scrollIndicatorRegistry.forEach(({ update }) => update());
       }

       document.querySelectorAll('.options-scroll-container').forEach(attachScrollIndicator);

       const categoriesOtherCheckbox = document.getElementById('categoriesOtherCheckbox');
       const categoriesOtherInput = document.getElementById('categoriesOtherInput');
       const categoriesScrollContainer = document.querySelector('#question10 .options-scroll-container');

       function refreshOtherCategorySelection(options = {}) {
           if (!categoriesOtherCheckbox || !categoriesOtherInput) return;
           const hasText = categoriesOtherInput.value.trim().length > 0;
           categoriesOtherCheckbox.checked = hasText;
           const container = categoriesOtherCheckbox.closest('.options-container');
           if (container) updateCardSelection(container);
           if (options.focus && !hasText) {
               categoriesOtherInput.focus();
           }
           if (categoriesScrollContainer) {
               updateScrollIndicator(categoriesScrollContainer);
           }
       }

       if (categoriesOtherInput && categoriesOtherCheckbox) {
            categoriesOtherInput.addEventListener('input', () => {
                refreshOtherCategorySelection();
               saveQuizProgress();
               updateButtons();
           });

           categoriesOtherCheckbox.addEventListener('change', () => {
               if (!categoriesOtherCheckbox.checked) {
                   categoriesOtherInput.value = '';
                   refreshOtherCategorySelection();
               } else {
                   refreshOtherCategorySelection({ focus: true });
               }
               saveQuizProgress();
               updateButtons();
           });
       }

       function initSalaryQuestion() {
           if (!salaryInitialized) {
               const barsContainer = document.getElementById('histogramBars');
               for (let i = 0; i < 24; i++) {
                   const bar = document.createElement('div');
                   bar.className = 'histogram-bar';
                   barsContainer.appendChild(bar);
               }

               const selectedCats = Array.from(document.querySelectorAll('input[name="categories"]:checked')).map(i => i.value);
               if (selectedCats.length) {
                   const defaults = categorySalaryMap[selectedCats[0]];
                   if (defaults?.mensuel) {
                       salaryData.min = defaults.mensuel.min;
                       salaryData.max = defaults.mensuel.max;
                   }
               }

               document.getElementById('salaryMin').addEventListener('change', e => handleInputChange(e, 'min'));
               document.getElementById('salaryMax').addEventListener('change', e => handleInputChange(e, 'max'));

               document.querySelectorAll('.salary-tab').forEach(tab => {
                   tab.addEventListener('click', () => switchSalaryPeriod(tab.dataset.period));
               });
               setupHandles();
               salaryInitialized = true;
           }
           updateSalaryUI();
           updatePlotArea();
           updateHandlePositions();
           updateRatios();
       }

       function switchSalaryPeriod(period) {
           if (salaryData.period === period) return;
           let newMin = convertFromMonthly(canonical.min, period);
           let newMax = convertFromMonthly(canonical.max, period);
           const cfg = salaryConfig[period];
           newMin = Math.max(cfg.min, Math.min(cfg.max, newMin));
           newMax = Math.max(cfg.min, Math.min(cfg.max, newMax));
           newMin = Math.round(newMin / cfg.step) * cfg.step;
           newMax = Math.round(newMax / cfg.step) * cfg.step;
           canonical.min = convertToMonthly(newMin, period);
           canonical.max = convertToMonthly(newMax, period);
           salaryData.period = period;
           salaryData.min = newMin;
           salaryData.max = newMax;
           updateSalaryUI();
           updatePlotArea();
           updateHandlePositions();
           updateRatios();
           saveQuizProgress();
       }

       function updatePlotArea() {
           const bars = document.getElementById('histogramBars');
           const rect = bars.getBoundingClientRect();
           const containerRect = document.querySelector('.histogram-container').getBoundingClientRect();
           plotArea = { left: rect.left, right: rect.right, width: rect.width };
           const track = document.getElementById('rangeTrack');
           track.style.left = (rect.left - containerRect.left) + 'px';
           track.style.width = rect.width + 'px';
       }

       function valueToPixel(value) {
           const cfg = salaryConfig[salaryData.period];
           return plotArea.left + (value - cfg.min) / (cfg.max - cfg.min) * plotArea.width;
       }

       function pixelToValue(pixel) {
           const cfg = salaryConfig[salaryData.period];
           return cfg.min + (pixel - plotArea.left) / plotArea.width * (cfg.max - cfg.min);
       }

       function updateHandlePositions() {
           const cfg = salaryConfig[salaryData.period];
           const minHandle = document.getElementById('minHandle');
           const maxHandle = document.getElementById('maxHandle');
           minHandle.style.left = (valueToPixel(salaryData.min) - plotArea.left) + 'px';
           maxHandle.style.left = (valueToPixel(salaryData.max) - plotArea.left) + 'px';
       }

       function updateRatios() {
           const cfg = salaryConfig[salaryData.period];
           rMin = (salaryData.min - cfg.min) / (cfg.max - cfg.min);
           rMax = (salaryData.max - cfg.min) / (cfg.max - cfg.min);
           canonical.min = convertToMonthly(salaryData.min, salaryData.period);
           canonical.max = convertToMonthly(salaryData.max, salaryData.period);
       }

       function setupHandles() {
           const handles = {
               min: document.getElementById('minHandle'),
               max: document.getElementById('maxHandle')
           };
           Object.entries(handles).forEach(([type, handle]) => {
               handle.addEventListener('pointerdown', e => {
                   activeHandle = type;
                   dragOffset = e.clientX - valueToPixel(type === 'min' ? salaryData.min : salaryData.max);
                   handle.setPointerCapture(e.pointerId);
               });
               handle.addEventListener('pointermove', e => {
                   if (activeHandle !== type) return;
                   const cfg = salaryConfig[salaryData.period];
                   let value = pixelToValue(e.clientX - dragOffset);
                   value = Math.round(value / cfg.step) * cfg.step;
                   value = Math.max(cfg.min, Math.min(cfg.max, value));
                   if (type === 'min') {
                       if (value > salaryData.max) salaryData.max = value;
                       salaryData.min = value;
                   } else {
                       if (value < salaryData.min) salaryData.min = value;
                       salaryData.max = value;
                   }
                   updateSalaryInputs();
                   updateHandlePositions();
                   updateRatios();
                   updateHistogram();
                   validateSalaryRange();
               });
               handle.addEventListener('pointerup', e => {
                   handle.releasePointerCapture(e.pointerId);
                   activeHandle = null;
                   saveQuizProgress();
               });
           });
       }

       function updateSalaryUI() {
           const cfg = salaryConfig[salaryData.period];
           document.querySelectorAll('.salary-tab').forEach(tab => {
               const selected = tab.dataset.period === salaryData.period;
               tab.classList.toggle('active', selected);
               tab.setAttribute('aria-selected', selected);
           });
           document.getElementById('unitMin').textContent = cfg.unit;
           document.getElementById('unitMax').textContent = cfg.unit;
           salaryData.min = Math.max(cfg.min, Math.min(cfg.max, salaryData.min));
           salaryData.max = Math.max(cfg.min, Math.min(cfg.max, salaryData.max));
           if (salaryData.min > salaryData.max) salaryData.min = salaryData.max;
           updateSalaryInputs();
           updateHistogram();
           validateSalaryRange();
       }

       function updateHistogram() {
           const cfg = salaryConfig[salaryData.period];
           const bars = document.querySelectorAll('.histogram-bar');
           const eps = cfg.step / 2;
           bars.forEach((bar, i) => {
               bar.style.height = cfg.heights[i] + '%';
               const center = cfg.centers[i];
               if (center >= salaryData.min - eps && center <= salaryData.max + eps) {
                   bar.classList.add('in-range');
               } else {
                   bar.classList.remove('in-range');
               }
           });
       }

       function handleInputChange(e, type) {
           const cfg = salaryConfig[salaryData.period];
           let value = parseInt(e.target.value.replace(/\s/g, ''), 10);
           if (isNaN(value)) value = type === 'min' ? salaryData.min : salaryData.max;
           value = Math.round(value / cfg.step) * cfg.step;
           value = Math.max(cfg.min, Math.min(cfg.max, value));
           if (type === 'min') {
               if (value > salaryData.max) salaryData.max = value;
               salaryData.min = value;
           } else {
               if (value < salaryData.min) salaryData.min = value;
               salaryData.max = value;
           }
           updateSalaryInputs();
           updateHandlePositions();
           updateRatios();
           updateHistogram();
           validateSalaryRange();
           saveQuizProgress();
       }

       function updateSalaryInputs() {
           document.getElementById('salaryMin').value = formatValue(salaryData.min);
           document.getElementById('salaryMax').value = formatValue(salaryData.max);
       }

       function formatValue(v) {
           return Math.round(v).toLocaleString('fr-FR');
       }

       function validateSalaryRange() {
           const nextBtn = document.getElementById('nextBtn');
           if (currentQuestion === 12 && salaryData.min <= salaryData.max) {
               nextBtn.disabled = false;
               nextBtn.classList.remove('disabled');
           } else if (currentQuestion === 12) {
               nextBtn.disabled = true;
               nextBtn.classList.add('disabled');
           }
       }

       function skipQuestion(e) {
           e.preventDefault();
           changeQuestion(1);
       }

       function fillSummaryScreen(){
           const niveau = document.querySelector('input[name="niveau"]:checked')?.value;
           const etudes = document.querySelector('input[name="etudes"]:checked')?.value;
           const ang = document.querySelector('input[name="anglais"]:checked')?.value;

           let expTitle='Intermédiaire', expText="Beaucoup d'équipes encadrent les profils en montée.";
           if (niveau==='junior'){ expTitle='Junior'; expText='On mettra en avant les équipes avec mentoring.'; }
           if (niveau==='senior' || niveau==='lead' || niveau==='direction'){ expTitle='Senior'; expText='Autonomie recherchée : accès aux rôles à responsabilité.'; }
           if (niveau==='debutant'){ expTitle='Débutant'; expText='Les entreprises remote adorent former des talents motivés.'; }
           if (niveau==='confirme'){ expTitle='Confirmé'; expText='Profil idéal : autonome avec expertise prouvée.'; }

           let degreeTitle='Master / Grande École', degreeText='Vous êtes dans les profils les plus qualifiés.';
           if (etudes==='doctorat'){ degreeTitle='Doctorat (PhD)'; degreeText='Forte crédibilité recherche & data.'; }
           if (etudes==='bac+3' || etudes==='bac+2'){ degreeTitle='Licence / BTS'; degreeText='On valorise vos réalisations concrètes.'; }
           if (etudes==='bac' || etudes==='sans-diplome'){ degreeTitle='Parcours atypique'; degreeText="L'expérience compte plus que les diplômes en remote."; }

           const mapEn = {
               A1:'A1 · Débutant',
               A2:'A2 · Élémentaire',
               B1:'B1 · Intermédiaire',
               B2:'B2 · Avancé',
               C1:'C1 · Autonome',
               C2:'C2 · Maîtrise',
               natif:'Anglais natif'
           };
           let enTitle = mapEn[ang] || 'Anglais';
           let enText = "L'anglais ouvre l'accès aux meilleures offres internationales.";
           if (ang==='A1' || ang==='A2') enText='On démarre sur des offres FR ciblées.';
           if (ang==='B1') enText="On priorisera d'abord les offres FR/UE adaptées.";
           if (ang==='B2') enText='Niveau de travail : accès à la plupart des offres Europe.';
           if (ang==='C1' || ang==='C2' || ang==='natif') enText='Accès illimité aux offres internationales !';

           document.getElementById('sum-exp-title').textContent = expTitle;
           document.getElementById('sum-exp-text').textContent = expText;
           document.getElementById('sum-degree-title').textContent = degreeTitle;
           document.getElementById('sum-degree-text').textContent = degreeText;
           document.getElementById('sum-en-title').textContent = enTitle;
           document.getElementById('sum-en-text').textContent = enText;
       }

       function fillContractInfo() {
           const selected = Array.from(document.querySelectorAll('input[name="contrat"]:checked')).map(input => input.nextElementSibling.textContent.trim());
           let formatted = '';
           if (selected.length === 1) {
               formatted = selected[0];
           } else if (selected.length === 2) {
               formatted = selected[0] + ' et ' + selected[1];
           } else if (selected.length > 2) {
               formatted = selected.slice(0, -1).join(', ') + ' et ' + selected[selected.length - 1];
           }
           document.getElementById('contractInfoText').innerHTML = `Nous avons de nombreuses offres en <strong>${formatted}</strong> qui correspondent à vos attentes.`;
       }

       function changeQuestion(direction) {
           const currentSection = document.getElementById(`question${currentQuestion}`);

           if (currentQuestion === 4 && direction === 1 && !document.getElementById('info-summary').classList.contains('active')) {
               const required = [
                   document.querySelector('input[name="niveau"]:checked'),
                   document.querySelector('input[name="etudes"]:checked'),
                   document.querySelector('input[name="anglais"]:checked')
               ];
               if (required.some(x => !x)) { alert('Merci de compléter les étapes précédentes'); return; }

               currentSection.classList.remove('active');
               fillSummaryScreen();
               document.getElementById('info-summary').classList.add('active');
               updateButtons();
               return;
           }

           const summaryScreen = document.querySelector('#info-summary.active');
           if (summaryScreen && direction === 1) {
               summaryScreen.classList.remove('active');
               currentQuestion = 5;
               document.getElementById('question5').classList.add('active');
               updateProgress();
               updateButtons();
               updateStepIndicator();
               return;
           }

           if (summaryScreen && direction === -1) {
               summaryScreen.classList.remove('active');
               currentQuestion = 4;
               document.getElementById('question4').classList.add('active');
               updateButtons();
               return;
           }

           const activeInfoScreen = document.querySelector('.info-screen.active');
           if (activeInfoScreen) {
               if (direction === 1) {
                   activeInfoScreen.classList.remove('active');
                   if (!hasShownReviews) {
                       lastInfoScreen = activeInfoScreen.id;
                       document.getElementById('reviews-screen').classList.add('active');
                       hasShownReviews = true;
                       updateButtons();
                       return;
                   } else {
                       currentQuestion = infoNextQuestion;
                       document.getElementById(`question${currentQuestion}`).classList.add('active');
                       updateProgress();
                       updateButtons();
                       updateStepIndicator();
                       return;
                   }
               } else if (direction === -1) {
                   activeInfoScreen.classList.remove('active');
                   document.getElementById(`question${currentQuestion}`).classList.add('active');
                   updateButtons();
                   return;
               }
           }

           const activeReviews = document.querySelector('.reviews-screen.active');
           if (activeReviews) {
               if (direction === 1) {
                   activeReviews.classList.remove('active');
                   currentQuestion = infoNextQuestion;
                   document.getElementById(`question${currentQuestion}`).classList.add('active');
                   updateProgress();
                   updateButtons();
                   updateStepIndicator();
                   return;
               } else if (direction === -1) {
                   activeReviews.classList.remove('active');
                   document.getElementById(lastInfoScreen).classList.add('active');
                   updateButtons();
                   return;
               }
           }

           if (currentQuestion === 1 && direction === 1) {
               const selectedExperience = document.querySelector('input[name="experience"]:checked');
               if (!selectedExperience) {
                   alert('Merci de faire un choix');
                   return;
               }
               currentSection.classList.remove('active');
               switch(selectedExperience.value) {
                   case 'premier': document.getElementById('info-premier').classList.add('active'); break;
                   case 'moins1': document.getElementById('info-moins1').classList.add('active'); break;
                   case '1-2': document.getElementById('info-1-2').classList.add('active'); break;
                   case '3-5': document.getElementById('info-3-5').classList.add('active'); break;
                   case '6+': document.getElementById('info-6plus').classList.add('active'); break;
               }
               lastInfoScreen = document.querySelector('.info-screen.active').id;
               infoNextQuestion = 2;
               reviewNextQuestion = 2;
               updateButtons();
               return;
           }

           function shouldShowQuestion(questionNum) {
               if (questionNum === 17) {
                   const hasFreelance = Array.from(document.querySelectorAll('input[name="contrat"]:checked')).some(i => i.value === 'freelance');
                   return hasFreelance;
               }
               if (questionNum === 18) {
                   const selectedNiveau = document.querySelector('input[name="niveau"]:checked')?.value;
                   return selectedNiveau === 'lead' || selectedNiveau === 'direction';
               }
               return true;
           }

           if (direction === 1 && currentQuestion !== 11) {
               const inputs = currentSection.querySelectorAll('input[type="radio"], input[type="checkbox"]');
               if (inputs.length > 0) {
                   const hasSelection = Array.from(inputs).some(input => input.checked);
                   if (!hasSelection) {
                       alert('Merci de faire un choix');
                       return;
                   }
               }
           }

           if (currentQuestion === 5 && direction === 1) {
               currentSection.classList.remove('active');
               fillContractInfo();
               document.getElementById('info-contrat').classList.add('active');
               infoNextQuestion = 6;
               updateButtons();
               return;
           }

           if (currentQuestion === 7 && direction === 1) {
               currentSection.classList.remove('active');
               document.getElementById('info-autoapply').classList.add('active');
               infoNextQuestion = 8;
               updateButtons();
               return;
           }

           if (direction === -1 && (currentQuestion === 6 || currentQuestion === 8)) {
               currentSection.classList.remove('active');
               currentQuestion--;
               const infoId = currentQuestion === 5 ? 'info-contrat' : 'info-autoapply';
               document.getElementById(infoId).classList.add('active');
               updateProgress();
               updateButtons();
               updateStepIndicator();
               return;
           }

           if (direction === -1 && currentQuestion === reviewNextQuestion && hasShownReviews) {
               currentSection.classList.remove('active');
               currentQuestion--;
               document.getElementById('reviews-screen').classList.add('active');
               updateProgress();
               updateButtons();
               updateStepIndicator();
               return;
           }

           currentSection.classList.remove('active');

           if (direction === 1) {
               currentQuestion++;
               while (currentQuestion <= totalQuestions && !shouldShowQuestion(currentQuestion)) {
                   currentQuestion++;
               }
           } else {
               currentQuestion--;
               while (currentQuestion > 0 && !shouldShowQuestion(currentQuestion)) {
                   currentQuestion--;
               }
           }

           if (currentQuestion < 1) currentQuestion = 1;
           if (currentQuestion > totalQuestions) {
               showSuccess();
               return;
           }

           document.getElementById(`question${currentQuestion}`).classList.add('active');
           updateAllScrollIndicators();
           if (currentQuestion === 12) {
               initSalaryQuestion();
           }
           updateProgress();
           updateButtons();
           updateStepIndicator();
       }

       function updateProgress() {
           const progress = (currentQuestion / totalQuestions) * 100;
           document.getElementById('progressBar').style.width = progress + '%';
       }

       function isQuestionAnswered(qNum) {
           if (qNum === 11 || qNum === 12) return true;
           const section = document.getElementById(`question${qNum}`);
           if (!section) return true;
           const checked = section.querySelector('input[type="radio"]:checked, input[type="checkbox"]:checked');
           if (checked) return true;
           const select = section.querySelector('select');
           if (select) return select.value !== '';
           return false;
       }

       function updateButtons() {
           const backBtn = document.getElementById('backBtn');
           const nextBtn = document.getElementById('nextBtn');

           if (document.querySelector('.info-screen.active') || document.querySelector('.reviews-screen.active')) {
               backBtn.style.display = 'flex';
           } else {
               backBtn.style.display = currentQuestion === 1 ? 'none' : 'flex';
           }
           nextBtn.style.display = 'block';
           nextBtn.textContent = currentQuestion === totalQuestions ? 'Terminer' : 'Continuer';
           if (currentQuestion === 12) {
               validateSalaryRange();
           } else if (isQuestionAnswered(currentQuestion)) {
               nextBtn.disabled = false;
               nextBtn.classList.remove('disabled');
           } else {
               nextBtn.disabled = true;
               nextBtn.classList.add('disabled');
           }
       }

       function updateStepIndicator() {
           document.getElementById('stepIndicator').textContent = `${currentQuestion}/19`;
       }

       function handleCvUpload(event) {
           const fileInput = event.target;
           const container = document.getElementById('cv-upload-container');
           const content = container.querySelector('.file-upload-content');
           const uploaded = container.querySelector('.uploaded-file');
           const nameSpan = container.querySelector('.uploaded-file-name');
           if (fileInput.files && fileInput.files.length > 0) {
               nameSpan.textContent = fileInput.files[0].name;
               content.style.display = 'none';
               uploaded.style.display = 'flex';
               saveQuizProgress();
           }
       }

       function removeCvFile(e) {
           e.stopPropagation();
           const fileInput = document.getElementById('cv-upload');
           const container = document.getElementById('cv-upload-container');
           const content = container.querySelector('.file-upload-content');
           const uploaded = container.querySelector('.uploaded-file');
           fileInput.value = '';
           uploaded.style.display = 'none';
           content.style.display = 'block';
           saveQuizProgress();
       }

       function showSuccess() {
           document.getElementById('quizApp').style.display = 'none';
           document.getElementById('resultsWrapper').style.display = 'flex';
           startSearchProgress();
           console.log('Quiz terminé ! Collecte des réponses...');
           collectResponses();
       }

       function collectResponses() {
           const responses = getQuizResponses();
           console.log('Réponses utilisateur:', responses);
       }

       function getQuizResponses() {
           const categories = [];
           Array.from(document.querySelectorAll('input[name="categories"]:checked')).forEach(input => {
               if (input.value !== 'other') {
                   categories.push(input.value);
               }
           });
           const otherCategory = categoriesOtherInput?.value.trim();

           if (otherCategory) {
               categories.push(`autre: ${otherCategory}`);
           }

           return {
               q1_experience: document.querySelector('input[name="experience"]:checked')?.value,
               q2_niveau: document.querySelector('input[name="niveau"]:checked')?.value,
               q3_etudes: document.querySelector('input[name="etudes"]:checked')?.value,
               q4_anglais: document.querySelector('input[name="anglais"]:checked')?.value,
               q5_contrats: Array.from(document.querySelectorAll('input[name="contrat"]:checked')).map(i => i.value),
               q6_disponibilite: document.querySelector('input[name="disponibilite"]:checked')?.value,
               q7_temps: document.querySelector('input[name="temps"]:checked')?.value,
               q8_pays: document.getElementById('countrySelect').value,
               q9_typeOffres: Array.from(document.querySelectorAll('input[name="type-offres"]:checked')).map(i => i.value),
               q10_categories: categories,
               q11_cv: document.getElementById('cv-upload').files[0]?.name || '',
               q12_salaire: { period: salaryData.period, min: salaryData.min, max: salaryData.max, currency: salaryData.currency },
               q13_rythme: document.querySelector('input[name="rythme"]:checked')?.value,
               q14_equipe: Array.from(document.querySelectorAll('input[name="equipe"]:checked')).map(i => i.value),
               q15_tailles: Array.from(document.querySelectorAll('input[name="taille"]:checked')).map(i => i.value),
               q16_priorite: document.querySelector('input[name="priorite"]:checked')?.value,
               q17_freelanceStatut: document.querySelector('input[name="freelance-statut"]:checked')?.value || 'N/A',
               q18_management: document.querySelector('input[name="management"]:checked')?.value || 'N/A'
           };
       }

       function saveQuizProgress() {
           try {
               localStorage.setItem('quizResponses', JSON.stringify(getQuizResponses()));
           } catch (err) {
               console.warn('localStorage inaccessible', err);
           }
       }

       function loadQuizProgress() {
           try {
               const stored = JSON.parse(localStorage.getItem('quizResponses') || '{}');
               if (!stored) return;
               if (stored.q1_experience) {
                   const el = document.querySelector(`input[name="experience"][value="${stored.q1_experience}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q2_niveau) {
                   const el = document.querySelector(`input[name="niveau"][value="${stored.q2_niveau}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q3_etudes) {
                   const el = document.querySelector(`input[name="etudes"][value="${stored.q3_etudes}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q4_anglais) {
                   const el = document.querySelector(`input[name="anglais"][value="${stored.q4_anglais}"]`);
                   if (el) el.checked = true;
               }
               if (Array.isArray(stored.q5_contrats)) {
                   stored.q5_contrats.forEach(v => {
                       const el = document.querySelector(`input[name="contrat"][value="${v}"]`);
                       if (el) el.checked = true;
                   });
               }
               if (stored.q6_disponibilite) {
                   const el = document.querySelector(`input[name="disponibilite"][value="${stored.q6_disponibilite}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q7_temps) {
                   const el = document.querySelector(`input[name="temps"][value="${stored.q7_temps}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q8_pays) {
                   const select = document.getElementById('countrySelect');
                   if (select) select.value = stored.q8_pays;
               }
               if (Array.isArray(stored.q9_typeOffres)) {
                   stored.q9_typeOffres.forEach(v => {
                       const el = document.querySelector(`input[name="type-offres"][value="${v}"]`);
                       if (el) el.checked = true;
                   });
               }
               if (Array.isArray(stored.q10_categories)) {
                   stored.q10_categories.forEach(v => {
                       if (typeof v !== 'string') return;
                       const value = v.trim();
                       if (!value) return;
                       if (/^autre\s*:/i.test(value)) {
                           const customValue = value.split(':').slice(1).join(':').trim();
                           if (categoriesOtherInput) {
                               categoriesOtherInput.value = customValue;
                           }
                           refreshOtherCategorySelection();
                       } else {
                           const el = document.querySelector(`input[name="categories"][value="${value}"]`);
                           if (el) el.checked = true;
                       }
                   });
                   const container = document.querySelector('#question10 .options-container');
                   if (container) updateCardSelection(container);
               }
               if (stored.q12_salaire) {
                   salaryData.period = stored.q12_salaire.period || salaryData.period;
                   salaryData.min = stored.q12_salaire.min ?? salaryData.min;
                   salaryData.max = stored.q12_salaire.max ?? salaryData.max;
                   salaryData.currency = stored.q12_salaire.currency || salaryData.currency;
                   updateSalaryUI();
                   updatePlotArea();
                   updateHandlePositions();
                   updateSalaryInputs();
                   updateRatios();
               }
               if (stored.q13_rythme) {
                   const el = document.querySelector(`input[name="rythme"][value="${stored.q13_rythme}"]`);
                   if (el) el.checked = true;
               }
               if (Array.isArray(stored.q14_equipe)) {
                   stored.q14_equipe.forEach(v => {
                       const el = document.querySelector(`input[name="equipe"][value="${v}"]`);
                       if (el) el.checked = true;
                   });
               }
               if (Array.isArray(stored.q15_tailles)) {
                   stored.q15_tailles.forEach(v => {
                       const el = document.querySelector(`input[name="taille"][value="${v}"]`);
                       if (el) el.checked = true;
                   });
               }
               if (stored.q16_priorite) {
                   const el = document.querySelector(`input[name="priorite"][value="${stored.q16_priorite}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q17_freelanceStatut && stored.q17_freelanceStatut !== 'N/A') {
                   const el = document.querySelector(`input[name="freelance-statut"][value="${stored.q17_freelanceStatut}"]`);
                   if (el) el.checked = true;
               }
               if (stored.q18_management && stored.q18_management !== 'N/A') {
                   const el = document.querySelector(`input[name="management"][value="${stored.q18_management}"]`);
                   if (el) el.checked = true;
               }
               updateExperienceSelection();
               document.querySelectorAll('.options-container').forEach(container => updateCardSelection(container));
           } catch (err) {
               console.warn('Impossible de charger les réponses du quiz', err);
           }
       }

       let searchProgress = 0;
       let currentSearchStep = 0;
       const totalSearchSteps = 5;

       function startSearchProgress() {
           searchProgress = 0;
           currentSearchStep = 0;
           const wrapper = document.getElementById('resultsWrapper');
           const bar = wrapper.querySelector('#searchProgressBar');
           const percentage = wrapper.querySelector('#searchProgressPercentage');
           const items = wrapper.querySelectorAll('.checklist-item');
           bar.style.width = '0%';
           percentage.textContent = '0%';
           items.forEach(item => item.classList.remove('active', 'completed'));
           setTimeout(updateSearchProgress, 500);
       }

       function updateSearchProgress() {
           const wrapper = document.getElementById('resultsWrapper');
           const bar = wrapper.querySelector('#searchProgressBar');
           const percentage = wrapper.querySelector('#searchProgressPercentage');
           const items = wrapper.querySelectorAll('.checklist-item');

           searchProgress += 2;
           if (searchProgress > 100) searchProgress = 100;

           bar.style.width = searchProgress + '%';
           percentage.textContent = Math.floor(searchProgress) + '%';

           const stepProgress = Math.floor((searchProgress / 100) * totalSearchSteps);
           if (stepProgress > currentSearchStep) {
               for (let i = currentSearchStep; i < stepProgress && i < totalSearchSteps; i++) {
                   setTimeout(() => {
                       items[i].classList.add('active');
                       setTimeout(() => {
                           items[i].classList.add('completed');
                       }, 200);
                   }, i * 100);
               }
               currentSearchStep = stepProgress;
           }

           if (searchProgress < 100) {
               setTimeout(updateSearchProgress, 100);
           } else {
               items.forEach((item, index) => {
                   setTimeout(() => {
                       item.classList.add('active', 'completed');
                   }, index * 50);
               });
               setTimeout(showSearchSuccess, 1500);
           }
       }

       function showSearchSuccess() {
           const progressCard = document.getElementById('searchProgressCard');
           const successCard = document.getElementById('searchSuccessCard');
           const headerTitle = document.querySelector('#resultsWrapper .header-title');

           progressCard.classList.add('hidden');
           headerTitle.style.opacity = '0';
           headerTitle.style.transform = 'translateY(-20px)';

           setTimeout(() => {
               progressCard.style.display = 'none';
               headerTitle.style.display = 'none';
               successCard.classList.add('visible');
           }, 400);
       }

       function showEmailQuestion() {
           const successCard = document.getElementById('searchSuccessCard');
           const emailQuestion = document.getElementById('emailQuestion');
           successCard.style.display = 'none';
           emailQuestion.style.display = 'flex';
           setEmailQuestionStep('identity');
       }

       document.querySelectorAll('input, select').forEach(el => {
           el.addEventListener('change', () => {
               saveQuizProgress();
               updateButtons();
           });
       });

       loadQuizProgress();
       updateProgress();
       updateStepIndicator();
       updateButtons();
       updateAllScrollIndicators();
   </script>
   <script>
/**
 * Affiche les champs SIO (prénom/nom/email) UNIQUEMENT dans l’étape email,
 * et évite qu’ils n’apparaissent avant relocalisation.
 * - Les inputs sont globalement masqués par CSS.
 * - On les “déverrouille” seulement à l’intérieur de #sioFieldsMount.
 * - Le relocator ne se lance qu’à l’ouverture de l’étape email.
 */
(function () {
  const q  = (sel, root=document)=>root.querySelector(sel);
  const qa = (sel, root=document)=>Array.from(root.querySelectorAll(sel));

  // 1) Gate CSS : masquer partout, n’afficher que dans #sioFieldsMount
  (function injectGateCss(){
    if (document.getElementById('remoteursFieldGate')) return;
    const style = document.createElement('style');
    style.id = 'remoteursFieldGate';
    style.textContent = `
      /* Masquer les champs SIO partout par défaut */
      input[name="first_name"], input[name="surname"], input[name="email"] { display: none !important; }
      /* Les afficher uniquement une fois déplacés dans notre mount */
      #sioFieldsMount input[name="first_name"],
      #sioFieldsMount input[name="surname"],
      #sioFieldsMount input[name="email"] { display: block !important; }
    `;
    (document.head || document.documentElement).appendChild(style);
  })();

  const FIELD_SPECS = [
    { name: 'first_name', key: 'quizFirstName', ph: 'Prénom', section: 'identity' },
    { name: 'surname',    key: 'quizLastName',  ph: 'Nom de famille', section: 'identity' },
    { name: 'email',      key: 'quizEmail',     ph: 'Email', section: 'email' }
  ];

  const SECTION_CONFIG = {
    identity: {
      sectionId: 'sioIdentitySection',
      mountId: 'sioIdentityMount',
      loadingId: 'sioIdentityLoading',
      title: 'Votre identité professionnelle',
      subtitle: 'Renseignez le nom par lequel les employeurs devront vous appeler. Utilisez exactement celui qui figure sur vos pièces d\'identité.',
      loadingText: 'Chargement des champs d’identité…'
    },
    email: {
      sectionId: 'sioEmailSection',
      mountId: 'sioEmailMount',
      loadingId: 'sioEmailLoading',
      title: 'Votre email professionnel',
      subtitle: "C'est ici que vous recevrez les réponses des recruteurs - utilisez une adresse que vous consultez régulièrement.",
      loadingText: 'Chargement du champ email…'
    }
  };

  const SUBMIT_SEL = [
    'button[type="submit"]','input[type="submit"]',
    '[data-test-id="send-form-button"]','[data-testid="send-form-button"]',
    'button[id^="button-"]','[data-element="submit"]',
    '.sio-subscribe-button','.sio-submit','[data-element="cta-button"]'
  ].join(', ');

  // ---------- Relocator (appelé UNIQUEMENT à l’ouverture de l’étape email) ----------
  function relocateSioFields() {
    const slot = document.getElementById('sioEmailSlot');
    if (!slot) return;

    // Créer le conteneur propre à l’étape
    let mount = q('#sioFieldsMount', slot);
    if (!mount) {
      mount = document.createElement('div');
      mount.id = 'sioFieldsMount';
      mount.style.display = 'flex';
      mount.style.flexDirection = 'column';
      mount.style.gap = '24px';
      slot.innerHTML = ''; // supprime le placeholder

      const buildSection = ({ sectionId, mountId, loadingId, title, subtitle, loadingText }) => {
        const section = document.createElement('div');
        if (sectionId) section.id = sectionId;
        section.classList.add('email-step');
        section.style.flexDirection = 'column';
        section.style.gap = '12px';

        const header = document.createElement('div');
        header.className = 'question-header';

        const h2 = document.createElement('h2');
        h2.className = 'question-title';
        h2.textContent = title;

        const p = document.createElement('p');
        p.className = 'question-subtitle';
        p.textContent = subtitle;

        header.appendChild(h2);
        header.appendChild(p);
        section.appendChild(header);

        const container = document.createElement('div');
        container.id = mountId;
        container.style.display = 'flex';
        container.style.flexDirection = 'column';
        container.style.gap = '8px';

        const loading = document.createElement('div');
        loading.id = loadingId;
        loading.className = 'input-field';
        loading.style.display = 'flex';
        loading.style.alignItems = 'center';
        loading.style.justifyContent = 'center';
        loading.style.height = '26.7px';
        loading.textContent = loadingText;

        container.appendChild(loading);
        section.appendChild(container);
        mount.appendChild(section);
      };

      Object.values(SECTION_CONFIG).forEach(buildSection);
      slot.appendChild(mount);
    }

    // Déplacer/styliser les 3 champs dans le mount
    FIELD_SPECS.forEach(({ name, key, ph, section }) => {
      const config = SECTION_CONFIG[section];
      if (!config) return;
      const container = q(`#${config.mountId}`, mount);
      if (!container) return;
      const inputs = qa(`input[name="${name}"]`);
      const input  = inputs.length ? inputs[inputs.length - 1] : null;
      if (!input) return;

      if (!container.contains(input)) {
        const loading = q(`#${config.loadingId}`, container);
        if (loading) loading.remove();
        const row  = document.createElement('div');
        const wrap = document.createElement('div');
        wrap.className = 'input-field';
        wrap.style.padding = '6.7px 14px';
        wrap.style.border = '2px solid #e5e7eb';
        wrap.style.borderRadius = '10px';

        input.style.width = '100%';
        input.style.border = '0';
        input.style.outline = 'none';
        input.style.fontSize = '0.95rem';
        if (!input.placeholder) input.placeholder = ph;

        wrap.appendChild(input);   // détache de l’ancien parent
        row.appendChild(wrap);
        container.appendChild(row);
      }

      // Prefill + save (localStorage)
      try {
        const saved = localStorage.getItem(key);
        if (saved && !input.value) input.value = saved;
        input.addEventListener('input', e => localStorage.setItem(key, e.target.value || ''));
      } catch {}
    });

    updateEmailStepDisplay();

    // Quand le <form> du champ email existe, insérer le mount dedans et masquer le submit natif
    const adoptIntoForm = () => {
      const email = q('input[name="email"]');
      const form  = email && (email.closest('form') || email.form);
      if (!form) return false;
      const anchor = q(SUBMIT_SEL, form);
      if (mount.parentElement !== form) {
        form.insertBefore(mount, anchor || form.firstChild);
      }
      const btn = q(SUBMIT_SEL, form);
      if (btn) btn.style.display = 'none';
      return true;
    };

    let ok = adoptIntoForm(), tries = 0;
    (function retry() {
      if (ok || tries >= 10) return;
      tries++;
      ok = adoptIntoForm();
      if (!ok) setTimeout(retry, 250);
    })();

    // Le bouton “Continuer” soumet le form SIO
    const continueBtn = q('#emailQuestion .continue-button');
    if (continueBtn && !continueBtn.dataset.sioBound) {
      continueBtn.dataset.sioBound = '1';
      continueBtn.addEventListener('click', e => {
        e.preventDefault();
        if (continueBtn.dataset.step !== 'email') {
          const firstNameInput = q('#sioIdentityMount input[name="first_name"]');
          const lastNameInput = q('#sioIdentityMount input[name="surname"]');
          const firstName = firstNameInput ? firstNameInput.value.trim() : '';
          const lastName = lastNameInput ? lastNameInput.value.trim() : '';

          if (!firstName || !lastName) {
            const targetInput = !firstName && firstNameInput ? firstNameInput : lastNameInput;
            if (targetInput && typeof targetInput.focus === 'function') {
              targetInput.focus();
            }
            alert('Merci de renseigner votre prénom et votre nom.');
            return;
          }

          setEmailQuestionStep('email');
          return;
        }
        const email = q('input[name="email"]');
        const form  = email && (email.closest('form') || email.form);
        const nativeBtn =
          (form && (q('button[type="submit"]', form) || q('input[type="submit"]', form))) ||
          q(SUBMIT_SEL, document);

        if (nativeBtn && typeof nativeBtn.click === 'function') {
          nativeBtn.style.display = 'none';
          nativeBtn.click(); // déclenche validations SIO
        } else if (form) {
          if (form.requestSubmit) form.requestSubmit(); else form.submit();
        }
      });
    }

    const backBtn = q('#emailStepBack');
    if (backBtn && !backBtn.dataset.sioBound) {
      backBtn.dataset.sioBound = '1';
      backBtn.addEventListener('click', e => {
        e.preventDefault();
        if (emailQuestionStep === 'email') {
          setEmailQuestionStep('identity');
        }
      });
    }
  }

  // ---------- Déclencheur tardif (à l’ouverture de l’étape email uniquement) ----------
  function runWhenEmailStepOpens() {
    // On “wrap” la fonction globale si elle existe
    if (typeof window.showEmailQuestion === 'function' && !window.showEmailQuestion.__wrapped) {
      const orig = window.showEmailQuestion;
      window.showEmailQuestion = function wrappedShowEmailQuestion() {
        const r = orig.apply(this, arguments);    // ouvre l’étape email
        setTimeout(relocateSioFields, 0);         // puis relocalise les champs
        return r;
      };
      window.showEmailQuestion.__wrapped = true;
      return;
    }

    // Fallback : observer l’apparition de #emailQuestion
    const target = document.getElementById('emailQuestion');
    if (target && getComputedStyle(target).display !== 'none') {
      relocateSioFields();
      return;
    }
    const mo = new MutationObserver(() => {
      const el = document.getElementById('emailQuestion');
      if (el && getComputedStyle(el).display !== 'none') {
        mo.disconnect();
        relocateSioFields();
      }
    });
    mo.observe(document.documentElement, { attributes: true, childList: true, subtree: true });
  }

  // Armement différé au chargement
  if (document.readyState === 'complete' || document.readyState === 'interactive') {
    runWhenEmailStepOpens();
  } else {
    document.addEventListener('DOMContentLoaded', runWhenEmailStepOpens);
  }
})();
   </script>
</body>
</html>
